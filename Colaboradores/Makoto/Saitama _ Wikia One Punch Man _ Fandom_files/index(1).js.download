/*! For license information please see index.js.LICENSE.txt */
(()=>{var e,t,i={3155:(e,t,i)=>{"use strict";i.d(t,{r:()=>n});class n{constructor(e,t){this.__global=!0,this.timestamp=Date.now(),this.name=e.name,this.category=e.category||"[Identity]",this.type=`${this.category} ${e.name}`,Object.assign(this,t)}}},4085:(e,t,i)=>{"use strict";i.d(t,{U:()=>k});var n=i(1635),r=function(){return r=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)},o={channelId:"default",host:window,coordinatorHost:window.top},s={connect:"connect",connected:"connected"},a="@wikia/post-quecast";function c(e){return e.channelId&&e.libId===a&&e.action&&function(e){return"string"==typeof e.type&&"number"==typeof e.timestamp}(e.action)}function l(e){return!e.data.private}function d(e,t){return e.data.channelId===t}function u(e){return e.data.action}var h=function(){function e(){}return e.make=function(e){return function(e){var t;return e.host===e.coordinatorHost&&!!(null===(t=e.coordinatorHost[a])||void 0===t?void 0:t.callbackConnector)}(e)?e.coordinatorHost[a].callbackConnector:new p({senderHost:e.coordinatorHost,listenerHost:e.host})},e}(),g=function(){function e(e){this.coordinatorHost=e,this.callbacks=[]}return e.prototype.dispatch=function(e){var t=this;if(!c(e))throw new Error("Incorrect object type. Expected PostMessageData, but got "+e);this.callbacks.forEach((function(i){return i({data:e,source:t.coordinatorHost})}))},e.prototype.addListener=function(e){this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter((function(t){return t!==e}))},e}(),p=function(){function e(e){this.options=e,this.map=new Map}return e.prototype.dispatch=function(e){if(!c(e))throw new Error("Incorrect object type. Expected PostMessageData, but got "+e);this.options.senderHost.postMessage(e,"*")},e.prototype.addListener=function(e){var t=function(t){var i;(i=t)&&i.source&&i.data&&c(i.data)&&e(t)};this.map.set(e,t),this.options.listenerHost.addEventListener("message",t)},e.prototype.removeListener=function(e){var t=this.map.get(e);this.options.listenerHost.removeEventListener("message",t),this.map.delete(e)},e}(),f=function(){function e(e){this.callbacks=[],this.history=[],this.channelId=e.channelId,this.connector=h.make(e),this.setupActions(),this.setupConnection()}return e.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},e.prototype.getHistory=function(){var e=this,t=function(i){if(d(i,e.channelId)&&function(e){return!!e.data.private}(i)){var n=u(i);(function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.some((function(t){return e.type===t}))})(n,s.connected)&&(e.connector.removeListener(t),e.handleActions.apply(e,n.history))}};this.connector.addListener(t)},e.prototype.listenEvent=function(){var e=this;this.connector.addListener((function(t){if(d(t,e.channelId)&&l(t)){var i=u(t);e.handleActions(i)}}))},e.prototype.handleActions=function(){for(var e,t=this,i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];(e=this.history).push.apply(e,i),i.forEach((function(e){return t.callbacks.forEach((function(t){return t(e)}))}))},e.prototype.setupConnection=function(){this.connector.dispatch({action:{type:s.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:a})},e.prototype.addListener=function(e){this.history.forEach((function(t){return e(t)})),this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter((function(t){return t!==e}))},e}(),v=function(){function e(e){void 0===e&&(e={});var t=r(r({},o),e);this.channelId=t.channelId,this.connector=h.make(t)}return e.prototype.dispatch=function(e){this.connector.dispatch({action:r(r({},e),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:a})},e}(),m=function(){function e(e){void 0===e&&(e={});var t=r(r({},o),e);this.transmitter=new v(t),this.receiver=new f(t)}return e.prototype.dispatch=function(e){this.transmitter.dispatch(e)},e.prototype.addListener=function(e){this.receiver.addListener(e)},e.prototype.removeListener=function(e){this.receiver.removeListener(e)},e}(),y=function(){function e(e,t){this.channelId=e,this.connectors=new Map,this.history=[],this.connectors.set(t,t[a].callbackConnector)}return e.prototype.addConnection=function(e){this.ensureConnector(e).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:a})},e.prototype.createConnectedAction=function(){return{type:s.connected,history:this.history,timestamp:Date.now()}},e.prototype.broadcast=function(e){var t=this;this.history.push(e),this.connectors.forEach((function(i){i.dispatch({action:e,channelId:t.channelId,libId:a})}))},e.prototype.ensureConnector=function(e){return this.connectors.has(e)||this.connectors.set(e,new p({senderHost:e,listenerHost:e})),this.connectors.get(e)},e}(),w=function(){function e(e){this.coordinatorHost=e,this.channels=new Map,this.callbackConnector=new g(e),this.postMessageConnector=new p({senderHost:e,listenerHost:e})}return e.prototype.init=function(){var e=this,t=function(t){l(t)||(e.handleConnect(t),e.handleBroadcast(t))};this.callbackConnector.addListener(t),this.postMessageConnector.addListener(t)},e.prototype.handleConnect=function(e){(function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.some((function(t){return e.data.action.type===t}))})(e,s.connect)&&this.ensureChannel(e.data.channelId).addConnection(e.source)},e.prototype.handleBroadcast=function(e){(function(e){return!Object.values(s).some((function(t){return e.data.action.type===t}))})(e)&&this.ensureChannel(e.data.channelId).broadcast(e.data.action)},e.prototype.ensureChannel=function(e){return this.channels.has(e)||this.channels.set(e,new y(e,this.coordinatorHost)),this.channels.get(e)},e}();function C(e){if(void 0===e&&(e=window),!e[a]){var t=new w(e);t.init(),e[a]=t}}var b=i(2223),S=i(7393);let k=class{constructor(e){this.window=e,this.history=new Map;const{channelId:t,coordinatorName:i}=this.getSettings();C(),this.communicator=new m({channelId:t||"default",coordinatorHost:e[i]||top})}emit(e){this.communicator.dispatch(e)}on(e,t){this.communicator.addListener((i=>this.run(i,e,t)))}once(e,t){this.communicator.addListener((i=>this.runOnce(i,e,t)))}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}run(e,t,i){this.ofType(e,t)&&i(e)}runOnce(e,t,i){const n=t.category+" "+t.name;this.ofType(e,t)&&(this.history.has(n)||(this.history.set(n,!0),i(e)))}ofType(e,t){return e.category===t.category&&e.name===t.name||e.type===t.category+" "+t.name}};k=(0,n.Cg)([(0,b.Gr)(),(0,n.Qj)(0,(0,b.WQ)(S.jf))],k)},2349:(e,t,i)=>{"use strict";i.d(t,{c:()=>n});const n={CONSENT_READY:{category:"[AdEngine OptIn]",name:"set opt in"},CONSENT_UPDATE:{category:"[AdEngine OptIn]",name:"update opt in"},FANDOM_CONTEXT_SET:{category:"[IdentityEngine]",name:"Fandom context set"},IDENTITY_READY:{category:"[IdentityEngine]",name:"Identity ready"},SEND_ONETRUST_EVENTS:{category:"[IdentityEngine]",name:"Send OneTrust events"},IDENTITY_PARTNER_DATA_OBTAINED:{category:"[AdEngine]",name:"Identity partner data obtained"},AGE_GATE_DATA:{name:"Age gate result",category:"[Identity]"},PAGE_CHANGED:{name:"Page changed",category:"[Platform]"},UPDATE_CONSENT_COOKIE:{category:"[AdEngine]",name:"Update consent cookie"},AUDIGENT_SEGMENT_LIBRARY_LOADED:{name:"Audigent segment library loaded"},AUDIGENT_MATCHES_LIBRARY_LOADED:{name:"Audigent matches library loaded"},AUDIGENT_SEGMENTS_READY:{name:"Audigent segments ready"},EYEOTA_STARTED:{name:"Eyeota started"},EYEOTA_FAILED:{name:"Eyeota loading failed"},LIVE_CONNECT_STARTED:{name:"LiveConnect started"},LIVE_CONNECT_CACHED:{name:"LiveConnect data cached"},LIVE_CONNECT_RESPONDED_UUID:{name:"LiveConnect responded with UUID"}}},3841:(e,t,i)=>{"use strict";i.d(t,{X:()=>k});var n=i(1635),r=i(2223),o=i(5144),s=i(3858),a=i(2439),c=i(3710),l=i(6610);let d=class{constructor(e,t,i){this.adsContext=e,this.platform=t,this.device=i,this.skinMap={muthead:"turf",futhead:"turf",giantbomb:"giantbomb",gamefaqs:"gamefaqs",gamespot:"gamespot",metacritic:"metacritic","metacritic-neutron":"metacritic_neutron",comicvine:"comicvine",f2:"fandom",tvguide:"tvguide",fandomdesktop:"ucp",fandommobile:"ucp",fanatical:"fanatical"}}get(){var e,t;const i=this.platform.get(),n="desktop"===this.device.getDeviceType()?"desktop":"mobile";return(null===(e=this.adsContext.get())||void 0===e?void 0:e.skin)?`${null!==(t=this.adsContext.get().skin)&&void 0!==t?t:i}_${n}`:this.skinMap[i]?this.skinMap[i]+"_"+n:"unknown"}};d=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.WQ)(l.i)),(0,n.Qj)(1,(0,r.WQ)(a.O)),(0,n.Qj)(2,(0,r.WQ)(c.p))],d);var u=i(6167),h=i(1695),g=i(7546);let p=class{constructor(){this.operatingSystem=null}getOperatingSystem(){if(null!==this.operatingSystem)return this.operatingSystem;const{userAgent:e}=window.navigator;return this.operatingSystem="unknown",-1!==e.indexOf("Win")&&(this.operatingSystem="Windows"),-1!==e.indexOf("Mac")&&(this.operatingSystem="OSX"),-1!==e.indexOf("Linux")&&(this.operatingSystem="Linux"),-1!==e.indexOf("Android")&&(this.operatingSystem="Android"),-1!==e.indexOf("like Mac")&&(this.operatingSystem="iOS"),this.operatingSystem}};p=(0,n.Cg)([(0,r.Gr)()],p);var f=i(2712),v=i(7393);let m=class{constructor(e,t,i,n,r,o,s,a,c){this.logger=e,this.httpClient=t,this.skin=i,this.optInService=n,this.window=r,this.wikiConfig=o,this.geo=s,this.browser=a,this.operatingSystem=c;const l=new Date;this.startTime=this.getTimeOrigin(),this.tzOffset=l.getTimezoneOffset()}getTimeOrigin(){var e;return null===(e=window.performance)||void 0===e?void 0:e.timeOrigin}getCurrentTimestamp(){return Date.now()}getStartTime(){return this.startTime}getTimezoneOffset(){return this.tzOffset}getTrackingParams(){var e,t,i,n,r,o,s,a,c,l,d,u,h;return{browser:`${this.operatingSystem.getOperatingSystem()} ${this.browser.getBrowser()}`,browser_ts:this.getCurrentTimestamp(),tz_offset:this.getTimezoneOffset(),country:this.geo.getCountryCode()||"",session_id:null===(t=null===(e=this.window.fandomContext)||void 0===e?void 0:e.tracking)||void 0===t?void 0:t.sessionId,pv_number:null===(n=null===(i=this.window.fandomContext)||void 0===i?void 0:i.tracking)||void 0===n?void 0:n.pvNumber,pv_number_global:null===(o=null===(r=this.window.fandomContext)||void 0===r?void 0:r.tracking)||void 0===o?void 0:o.pvNumberGlobal,pv_unique_id:null===(a=null===(s=this.window.fandomContext)||void 0===s?void 0:s.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(l=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===l?void 0:l.beaconId,ua:null===(d=this.window.navigator)||void 0===d?void 0:d.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),u:this.optInService.trackingAllowed?this.wikiConfig.get("wgUserId")||0:-1,a:(null===(h=null===(u=this.window.fandomContext)||void 0===u?void 0:u.page)||void 0===h?void 0:h.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(e,t){if(!t)throw this.logger.error("Error building DWH tracking URL"),new Error("Error while building DWH tracking URL - no baseUrl provided");const i=new URLSearchParams(e);return i.sort(),`${t}?${i.toString()}`}sendEvent(e,t){var i;const n=this.buildDataWarehouseUrl(e,t);n&&(null===(i=this.httpClient.get(n,{mode:"cors"},5e3))||void 0===i||i.catch((e=>{this.logger.error("Failed to send data",e)})))}};m=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.MR)(o.V,o.O,"DataWarehouseSender")),(0,n.Qj)(1,(0,r.WQ)(s.Q)),(0,n.Qj)(2,(0,r.WQ)(d)),(0,n.Qj)(3,(0,r.WQ)(f.E)),(0,n.Qj)(4,(0,r.WQ)(v.jf)),(0,n.Qj)(5,(0,r.WQ)(u.j)),(0,n.Qj)(6,(0,r.WQ)(h.u)),(0,n.Qj)(7,(0,r.WQ)(g.P)),(0,n.Qj)(8,(0,r.WQ)(p))],m);let y=class{constructor(e){this.sender=e}send(e){const t=Object.assign(Object.assign(Object.assign({},e),this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(t,"https://beacon.wikia-services.com/__track/special/identityinfo")}};y=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(m))],y);var w=i(4489);let C=class{constructor(e){this.sender=e}send(e){const t=Object.assign(Object.assign({event_name:e,load_time:this.sender.getCurrentTimestamp()-this.sender.getStartTime()},this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(t,"https://beacon.wikia-services.com/__track/special/adengloadtimes")}};C=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(m))],C);let b=class{constructor(e){this.sender=e}send(e){const t=Object.assign(Object.assign({event_name:"chrome_label",label:e},this.sender.getTimeBasedParams()),this.sender.getTrackingParams());this.sender.sendEvent(t,"https://beacon.wikia-services.com/__track/special/chromelabels")}};b=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(m))],b);let S=class{constructor(e,t,i,n){this.window=e,this.geo=t,this.wikiConfig=i,this.sender=n}send(e){const t=Object.assign(Object.assign({},e),this.getTrackingParams());this.sender.sendEvent(t,"https://beacon.wikia-services.com/__track/special/gdpr_events")}getTrackingParams(){var e,t,i,n;return{lang_code:this.getLanguageCode()||"unknown",detected_geo:(this.geo.getCountryCode()||"").toUpperCase(),detected_region:(this.geo.getRegionCode()||"").toUpperCase(),beacon:null===(t=null===(e=this.window.fandomContext)||void 0===e?void 0:e.tracking)||void 0===t?void 0:t.beaconId,pv_unique_id:null===(n=null===(i=this.window.fandomContext)||void 0===i?void 0:i.tracking)||void 0===n?void 0:n.pvUID}}getLanguageCode(){var e,t,i;return this.wikiConfig.get("wgUserLanguage")||(null===(i=null===(t=null===(e=this.window)||void 0===e?void 0:e.navigator)||void 0===t?void 0:t.language)||void 0===i?void 0:i.toLowerCase().substring(0,2))}};S=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(v.jf)),(0,n.Qj)(1,(0,r.WQ)(h.u)),(0,n.Qj)(2,(0,r.WQ)(u.j)),(0,n.Qj)(3,(0,r.WQ)(m))],S);let k=class{constructor(e,t,i,n,r){this.logger=e,this.identityEventSender=t,this.loadTimeEventSender=i,this.chromeLabelSender=n,this.consentEventSender=r}track(e,t){switch(e){case w.i.identity:this.identityEventSender.send(t);break;case w.i.loadTime:this.loadTimeEventSender.send(t);break;case w.i.chromeLabel:this.chromeLabelSender.send(t);break;case w.i.consents:this.consentEventSender.send(t);break;default:this.logger.info("Invalid event type to track")}}};k=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.MR)(o.V,o.O,"DataWarehouseService")),(0,n.Qj)(1,(0,r.WQ)(y)),(0,n.Qj)(2,(0,r.WQ)(C)),(0,n.Qj)(3,(0,r.WQ)(b)),(0,n.Qj)(4,(0,r.WQ)(S))],k)},4489:(e,t,i)=>{"use strict";var n;i.d(t,{i:()=>n}),function(e){e[e.identity=0]="identity",e[e.loadTime=1]="loadTime",e[e.chromeLabel=2]="chromeLabel",e[e.consents=3]="consents"}(n||(n={}))},3905:(e,t,i)=>{"use strict";i.d(t,{q:()=>s});var n=i(1635),r=i(2223),o=i(5144);let s=class{constructor(e){this.logger=e}addLocatorFrame(){const e="____tcfapiLocator";if(window.frames[e])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const t=document.body,i=document.createElement("iframe");i.name=e,i.style.display="none",t.appendChild(i)}install(e=!1){const t=e?28:141;function i(e){try{let t=e.data;const i="string"==typeof t;if(i)try{t=JSON.parse(t)}catch(e){}const n=t.__tcfapiCall;n&&window.__tcfapi(n.command,n.parameter,(function(t,r){const o={__tcfapiReturn:{returnValue:t,success:r,callId:n.callId}};e.source.postMessage(i?JSON.stringify(o):o,"*")}))}catch(e){}}function n(e,i,n){"addEventListener"===e||"getTCData"===e||"ping"===e?n({cmpId:t,eventStatus:"tcloaded",cmpLoaded:!0,cmpStatus:"loaded",cmpVersion:i,displayStatus:"disabled",apiVersion:"2.2",tcfPolicyVersion:4,gdprApplies:!1},!0):n(void 0,!1)}window.__tcfapi?window.__tcfapi("ping",2,(e=>{"stub"===(null==e?void 0:e.cmpStatus)&&(window.__tcfapi=n,window.__tcfapi.msgHandler=i,this.addLocatorFrame(),window.addEventListener("message",i,!1),this.logger.info("__tcfapi installed"))})):(window.__tcfapi=n,window.__tcfapi.msgHandler=i,this.addLocatorFrame(),window.addEventListener("message",i,!1),this.logger.info("__tcfapi installed"))}};s=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.MR)(o.V,o.O,"TCF"))],s)},2517:(e,t,i)=>{"use strict";i.d(t,{h:()=>u,u:()=>n});var n,r=i(1635),o=i(2349),s=i(4085),a=i(2223),c=i(7393),l=i(4874),d=i(5144);!function(e){e.yes="Y",e.no="N",e.na="-"}(n||(n={}));let u=class{constructor(e,t,i,r){this.cookiesManager=e,this.window=t,this.logger=i,this.communicationService=r,this.usPrivacyCookie="usprivacy",this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.explicitNotice=n.yes,this.lspaSupport=n.no,this.addChangelistener()}isUspApiAvailable(){return void 0!==this.window.__uspapi}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener(),this.logger.info("__uspapi installed")}getPrivacyStringCookie(){return this.cookiesManager.get(this.usPrivacyCookie)}addChangelistener(){this.communicationService.on(o.c.UPDATE_CONSENT_COOKIE,(({uspValue:e})=>{this.createPrivacyCookie(e)}))}createPrivacyCookie(e=n.na){const t=this.window.location.hostname,i=l.O.extract(t),r=e===n.na?`${this.USP_API_VERSION}${n.na}${n.na}${n.na}`:`${this.USP_API_VERSION}${this.explicitNotice}${e}${this.lspaSupport}`;this.cookiesManager.set(this.usPrivacyCookie,r,{domain:i,expires:365})}consentsUpdated(e){return{gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!e.startsWith(this.CCPA_TRACKING_ALLOWED)}}uspApiMessage(e,t,i){"ping"===e?i({uspapiLoaded:!1},!0):"getUSPData"===e?i({version:this.USP_API_VERSION,uspString:this.getPrivacyStringCookie()},!0):"getQueue"===e?i(this.queue,!0):this.queue.push([e,t,i])}addLocatorFrame(){const e="__uspapi";if(this.window.frames[e])return;if("loading"===document.readyState)return void document.addEventListener("DOMContentLoaded",(()=>this.addLocatorFrame()));const t=document.createElement("iframe");t.name=e,t.style.display="none",document.body.appendChild(t)}addUspMessageListener(){this.window.addEventListener("message",(e=>{const t=this.convertUspMessageData(e);t&&this.uspMessageHandler(t,e)}),!1)}convertUspMessageData(e){try{return("string"==typeof e.data?JSON.parse(e.data):e.data).__uspapiCall}catch(e){}}uspMessageHandler(e,t){this.window.__uspapi(e.command,e.version,((i,n)=>{const r={__uspapiReturn:{returnValue:i,success:n,callId:e.callId}};t.source.postMessage(r,"*")}))}subscribe(e){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,(t=>{(null==t?void 0:t.uspString)&&e(this.consentsUpdated(t.uspString))}))}};u=(0,r.Cg)([(0,a.Gr)(),(0,r.Qj)(0,(0,a.WQ)(c.AZ)),(0,r.Qj)(1,(0,a.WQ)(c.jf)),(0,r.Qj)(2,(0,a.MR)(d.V,d.O,"USP")),(0,r.Qj)(3,(0,a.WQ)((0,a.cb)((()=>s.U))))],u)},2712:(e,t,i)=>{"use strict";i.d(t,{E:()=>m});var n=i(1635),r=i(5144),o=i(2223),s=i(3155),a=i(2349),c=i(4085),l=i(2439),d=i(8569),u=i(1695),h=i(2517),g=i(3905);let p=class{constructor(e,t,i){this.logger=e,this.uspApi=t,this.tcfApi=i,this.tcfApi.install()}subscribe(e){this.logger.info("__uspapi installed"),this.uspApi.subscribe(e)}};p=(0,n.Cg)([(0,o.Gr)(),(0,n.Qj)(0,(0,o.MR)(r.V,r.O,"OptInService")),(0,n.Qj)(1,(0,o.WQ)(h.h)),(0,n.Qj)(2,(0,o.WQ)(g.q))],p);var f=i(7393);let v=class{constructor(e,t,i,n){this.window=e,this.geo=t,this.platform=i,this.logger=n,this.ONE_TRUST_PLATFORMS=[l.l.GIANTBOMB,l.l.TVGUIDE,l.l.TVGUIDE_MTC,l.l.METACRITIC_NEUTRON,l.l.METACRITIC,l.l.GAMESPOT,l.l.COMICVINE,l.l.GAMEFAQS]}shouldLoadOneTrust(){return this.ONE_TRUST_PLATFORMS.includes(this.platform.get())}get(e=!1){if(this.shouldLoadOneTrust()||e){if(void 0===this.window.trackingOptIn||void 0===this.window.trackingOptInInstances)return i.e(832).then(i.bind(i,1675)).then((({OneTrustConsentStrategy:e})=>o.kL.resolve(e)));this.logger.warn("OneTrust should be loaded, but TrackingOptIn is present. Skipping OneTrust.")}if("fanatical"===this.platform.get())return i.e(482).then(i.bind(i,7341)).then((({FanaticalConsentStrategy:e})=>o.kL.resolve(e)));const t=this.geo.getCountryCode();if(t){if("us"===t)return Promise.resolve(o.kL.resolve(p));if(d.e.includes(t))return i.e(224).then(i.bind(i,8875)).then((({FandomGdprConsentStrategy:e})=>o.kL.resolve(e)))}return i.e(319).then(i.bind(i,3322)).then((({StaticConsentStrategy:e})=>o.kL.resolve(e)))}};v=(0,n.Cg)([(0,o.Gr)(),(0,n.Qj)(0,(0,o.WQ)(f.jf)),(0,n.Qj)(1,(0,o.WQ)(u.u)),(0,n.Qj)(2,(0,o.WQ)(l.O)),(0,n.Qj)(3,(0,o.MR)(r.V,r.O,"OptInService"))],v);let m=class{get trackingAllowed(){return this._trackingAllowed}set trackingAllowed(e){this._trackingAllowed=e}constructor(e,t,i){this.communicationService=e,this.logger=t,this.consentProviderFactory=i,this.consentUpdated=!1,this._trackingAllowed=!1}init(e){const t=e.get("icFandom1TEnabled",!1);this.consentProviderFactory.get(t).then((e=>e.subscribe((e=>{this.logger.info("Sending consents: ",e,"update?",this.consentUpdated),this.consentUpdated&&this.sendConsentsUpdateToAdEngine(e),this.sendConsentsToAdEngine(e),this.consentUpdated||(this.consentUpdated=!0)}))))}sendConsentsToAdEngine(e){this.communicationService.emit(new s.r(a.c.CONSENT_READY,e))}sendConsentsUpdateToAdEngine(e){this.communicationService.emit(new s.r(a.c.CONSENT_UPDATE,e))}};m=(0,n.Cg)([(0,o.Gr)(),(0,n.Qj)(0,(0,o.WQ)(c.U)),(0,n.Qj)(1,(0,o.MR)(r.V,r.O,"OptInService")),(0,n.Qj)(2,(0,o.WQ)(v))],m)},7393:(e,t,i)=>{"use strict";i.d(t,{AZ:()=>n,LT:()=>c,eF:()=>a,jf:()=>o,kW:()=>r,kk:()=>s});const n=Symbol("COOKIES"),r=Symbol("NAVIGATOR"),o=Symbol("WINDOW"),s=Symbol("UUID"),a=Symbol("SENTRY"),c=Symbol("NEW_RELIC")},6610:(e,t,i)=>{"use strict";i.d(t,{i:()=>s});var n=i(1635),r=i(2223),o=i(7393);let s=class{constructor(e){this.window=e}get(){var e;return null===(e=this.window.ads)||void 0===e?void 0:e.context}};s=(0,n.Cg)([(0,r._G)(),(0,n.Qj)(0,(0,r.WQ)(o.jf))],s)},3248:(e,t,i)=>{"use strict";i.d(t,{s:()=>o});var n=i(1635),r=i(2223);let o=class{constructor(){this.loadedAssets=[]}createScript(e,t="text/javascript",i=!0,n=null,r={},o={}){const s=document.createElement("script");if(s.async=i,s.defer=!i,s.type=t,s.src=e,Object.keys(r).forEach((e=>{s.setAttribute(e,r[e])})),Object.keys(o).forEach((e=>{s.dataset[e]=o[e]})),"string"==typeof n){const e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(s,e)}else(n||document.body).append(s);return s}loadScript(e,t="text/javascript",i=!0,n=null,r={},o={}){return new Promise(((s,a)=>{if(this.loadedAssets.includes(e))return s(null);const c=this.createScript(e,t,i,n,r,o);c.onload=s,c.onerror=a})).then((t=>(this.loadedAssets.push(e),t)))}};o=(0,n.Cg)([(0,r._G)()],o)},7546:(e,t,i)=>{"use strict";i.d(t,{P:()=>o});var n=i(1635),r=i(2223);let o=class{recognizeChromiumBuild(e,t){const i=t.match(/\b(OPR|Edg)\/(\d+)/);return null!==i?i.slice(1).join(" ").replace("OPR","Opera").replace("Edg","Edge"):"Chrome "+e}recognizeIEBuild(e){return`IE ${(/\brv[ :]+(\d+)/g.exec(e)||[""])[1]||""}`}getBrowserNameAndVersion(e){const[,t,i]=e.match(/(opera|chrome|safari|firefox|msie|trident|CriOS(?=\/))\/?\s*(\d+)/i)||[];return[t,i]}recognizeDefaultBrowser(e,t,i,n,r){const o=r?[n,r]:[t,i,"-?"],s=e.match(/version\/(\d+)/i);return null!==s&&o.splice(1,1,s[1]),o.join(" ")}getBrowser(){const{appName:e,appVersion:t,userAgent:i}=window.navigator,[n,r]=this.getBrowserNameAndVersion(i);return/trident/i.test(n)?this.recognizeIEBuild(i):"Chrome"===n||"CriOS"===n?this.recognizeChromiumBuild(r,i):this.recognizeDefaultBrowser(i,e,t,n,r)}};o=(0,n.Cg)([(0,r.Gr)()],o)},8569:(e,t,i)=>{"use strict";i.d(t,{e:()=>n});const n=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf","ad","br","cn"]},3710:(e,t,i)=>{"use strict";i.d(t,{p:()=>a});var n=i(1635),r=i(2223),o=i(7393),s=i(2439);let a=class{constructor(e,t){this.platform=t,this.testRegex=/Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i,this.userAgent=e.userAgent}getDeviceType(){const e=this.platform.get();return e===s.l.FANDOMDESKTOP?"desktop":e===s.l.FANDOMMOBILE||this.testRegex.test(this.userAgent)?"smartphone":"desktop"}};a=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.WQ)(o.kW)),(0,n.Qj)(1,(0,r.WQ)(s.O))],a)},1695:(e,t,i)=>{"use strict";i.d(t,{u:()=>c});var n=i(1635),r=i(2223),o=i(7393),s=i(8569);class a extends Error{constructor(e){super(e),this.name="GeoJsonParseException"}}let c=class{constructor(e,t){this.cookiesManager=e,this.window=t}get(){return this.geoData||(this.geoData=this.getGeoData()),this.geoData}set(e){this.geoData=e}getGeoData(){var e;if(void 0!==(null===(e=this.window.ads)||void 0===e?void 0:e.geo))return this.window.ads.geo;const t=this.getGeoDataFromCookie();return Object.keys(t).length?t:this.getGeoDataFromOneTrust()}getGeoDataFromCookie(){const e=this.cookiesManager.get("Geo");if(!e)return{};const t=decodeURIComponent(e);try{return JSON.parse(t)}catch(e){throw new a(`Failed to parse Geo cookie: ${e}`)}}getGeoDataFromOneTrust(){return this.window.OneTrust&&this.window.OneTrust.getGeolocationData()?{country:this.window.OneTrust.getGeolocationData().country}:{}}getCountryCode(){var e,t;return null===(t=null===(e=this.get())||void 0===e?void 0:e.country)||void 0===t?void 0:t.toLowerCase()}getRegionCode(){var e,t;return null===(t=null===(e=this.get())||void 0===e?void 0:e.region)||void 0===t?void 0:t.toLowerCase()}getContinentCode(){var e,t;return null===(t=null===(e=this.get())||void 0===e?void 0:e.continent)||void 0===t?void 0:t.toLowerCase()}isGdprCountry(){return s.e.includes(this.getCountryCode())}};c=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.WQ)(o.AZ)),(0,n.Qj)(1,(0,r.WQ)(o.jf))],c)},3858:(e,t,i)=>{"use strict";i.d(t,{Q:()=>a,j:()=>s});var n,r=i(1635),o=i(2223);class s extends Error{constructor(e){super(e),this.name=this.constructor.name}}let a=n=class{get(e){return(0,r.sH)(this,arguments,void 0,(function*(e,t={mode:"cors"},i=n.DEFAULT_TIMEOUT){return this.fetch(e,"GET",t,i)}))}put(e,t){return(0,r.sH)(this,arguments,void 0,(function*(e,t,i={mode:"cors"}){return this.fetch(e,"PUT",i,0,t)}))}fetch(e,t){return(0,r.sH)(this,arguments,void 0,(function*(e,t,i={mode:"cors"},n=0,r){let o,a;if(n>0){const e=new AbortController;a=setTimeout((()=>e.abort()),n),o=e.signal}try{const n=yield fetch(e,Object.assign({method:t,signal:o,headers:r?{"Content-Type":"application/json"}:void 0,body:r?JSON.stringify(r):void 0},i));if(void 0!==a&&clearTimeout(a),!n.ok)throw new s(`HTTP error ${e}! Status: ${n.status}`);return n}catch(t){if(t instanceof s)throw t;throw new s(`HTTP error ${t} while sending request to ${e}!`)}}))}};a.DEFAULT_TIMEOUT=1e3,a=n=(0,r.Cg)([(0,o._G)()],a)},8978:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});var n=i(1038);function r(){return"1"===n.C.get("identity_debug")}},5144:(e,t,i)=>{"use strict";i.d(t,{O:()=>c,V:()=>l});var n=i(1635),r=i(1038),o=i(2223),s=i(7393),a=i(8978);class c{transform(e,t){return e.setLoggerGroup(t)}}let l=class{constructor(e){var t,i;this.logGroup="Global",this.debugGroup=this.getDebugGroup()||"",this.groups=this.debugGroup.split(","),this.initTime=null!==(i=null===(t=null==e?void 0:e.performance)||void 0===t?void 0:t.timeOrigin)&&void 0!==i?i:Date.now()}setLoggerGroup(e){return this.logGroup=e,this}getTimeDelta(){return Date.now()-this.initTime}getDebugGroup(){return r.C.get("identity_debug")}getTimeDeltaFixed(){return(this.getTimeDelta()/1e3).toFixed(4)}info(...e){this.loggingEnabled()&&console.info(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,e)}warn(...e){this.loggingEnabled()&&console.warn(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,e)}error(...e){this.loggingEnabled()&&console.error(`${this.getTimeDeltaFixed()}s\t\t [IE] ${this.logGroup}`,e)}loggingEnabled(){return(0,a.A)()||-1!==this.groups.indexOf(this.logGroup)}};l=(0,n.Cg)([(0,o._G)(),(0,n.Qj)(0,(0,o.WQ)(s.jf))],l)},2439:(e,t,i)=>{"use strict";i.d(t,{O:()=>a,l:()=>n});var n,r=i(1635),o=i(2223),s=i(6610);!function(e){e.F2="f2",e.FUTHEAD="futhead",e.MUTHEAD="muthead",e.GAMESPOT="gamespot",e.COMICVINE="comicvine",e.GAMEFAQS="gamefaqs",e.METACRITIC="metacritic",e.METACRITIC_NEUTRON="metacritic-neutron",e.TVGUIDE="tvguide",e.TVGUIDE_MTC="tvguide-mtc",e.GIANTBOMB="giantbomb",e.FANATICAL="fanatical",e.FANDOMDESKTOP="fandomdesktop",e.FANDOMMOBILE="fandommobile"}(n||(n={}));let a=class{constructor(e){this.adsContext=e}get(){var e;const t=this.adsContext.get();return(null!==(e=null==t?void 0:t.platform)&&void 0!==e?e:null==t?void 0:t.app)||this.detectPlatform()}detectPlatform(){var e,t,i;return void 0!==window.mw&&void 0!==(null===(i=null===(t=null===(e=window.ads)||void 0===e?void 0:e.context)||void 0===t?void 0:t.opts)||void 0===i?void 0:i.platformName)?window.ads.context.opts.platformName:this.checkHostname()}checkHostname(){const{hostname:e,pathname:t}=window.location;switch(!0){case e.includes("fandom"):return n.F2;case e.includes("futhead"):return n.FUTHEAD;case e.includes("muthead"):return n.MUTHEAD;case e.includes("gamespot"):return e.includes("comicvine")?n.COMICVINE:e.includes("gamefaqs")?n.GAMEFAQS:n.GAMESPOT;case e.includes("metacritic"):return t.includes("news")?n.METACRITIC_NEUTRON:n.METACRITIC;case e.includes("tvguide"):return n.TVGUIDE;case e.includes("giantbomb"):return n.GIANTBOMB;case e.includes("fanatical"):return n.FANATICAL;default:return n.FANDOMDESKTOP}}};a=(0,r.Cg)([(0,o.Gr)(),(0,r.Qj)(0,(0,o.WQ)(s.i))],a)},1038:(e,t,i)=>{"use strict";i.d(t,{C:()=>n});class n{static getURLSearchParams(){const e=window.location.search.substring(1);return new URLSearchParams(e)}static get(e){return n.getURLSearchParams().get(e)}static stringify(e){const t=new URLSearchParams(e);return t.sort(),t.toString()}}},4874:(e,t,i)=>{"use strict";i.d(t,{O:()=>o});var n=i(1635),r=i(2223);let o=class{static extract(e){const t=e.split(".");if(t.length<2)return e;let i=`.${t[t.length-2]}.${t[t.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(i)>=0&&(i=`.${t[t.length-3]}${i}`),i}};o=(0,n.Cg)([(0,r._G)()],o)},6167:(e,t,i)=>{"use strict";i.d(t,{j:()=>s});var n=i(1635),r=i(2223),o=i(7393);let s=class{constructor(e){this.window=e}get(e,t=null){var i,n,r;return null!==(r=null===(n=null===(i=this.window.mw)||void 0===i?void 0:i.config)||void 0===n?void 0:n.get(e))&&void 0!==r?r:t}};s=(0,n.Cg)([(0,r.Gr)(),(0,n.Qj)(0,(0,r.WQ)(o.jf))],s)},2223:(e,t,i)=>{"use strict";var n;i.d(t,{kL:()=>T,cb:()=>g,WQ:()=>I,MR:()=>A,_G:()=>R,Gr:()=>_}),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(n||(n={}));const r=n;var o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},o(e,t)};function s(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}function a(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],n=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function l(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(c(arguments[t]));return e}function d(e){return!!e.useClass}function u(e){return!!e.useFactory}var h=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,i=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(t=e(i.wrap()),n=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(i){t[i]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t[0]=e(),Reflect[i].apply(void 0,l(t))}})),t},e}();function g(e){if(void 0===e)throw new Error("Attempt to `delay` undefined. Constructor must be wrapped in a callback");return new h(e)}function p(e){return"string"==typeof e||"symbol"==typeof e}function f(e){return"object"==typeof e&&"token"in e&&"transform"in e}function v(e){return!!e.useToken}function m(e){return null!=e.useValue}const y=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t}(y),C=function(){this.scopedResolutions=new Map};var b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t}(y),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s(t,e),t}(y);const k=function(){this.preResolution=new b,this.postResolution=new S};var E=new Map,Q=function(){function e(e){this.parent=e,this._registry=new w,this.interceptors=new k,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,i){var n;if(void 0===i&&(i={lifecycle:r.Transient}),this.ensureNotDisposed(),n=function(e){return d(e)||m(e)||v(e)||u(e)}(t)?t:{useClass:t},v(n))for(var o=[e],s=n;null!=s;){var a=s.useToken;if(o.includes(a))throw new Error("Token registration cycle detected! "+l(o,[a]).join(" -> "));o.push(a);var c=this._registry.get(a);s=c&&v(c.provider)?c.provider:null}if((i.lifecycle===r.Singleton||i.lifecycle==r.ContainerScoped||i.lifecycle==r.ResolutionScoped)&&(m(n)||u(n)))throw new Error('Cannot use lifecycle "'+r[i.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:i}),this},e.prototype.registerType=function(e,t){return this.ensureNotDisposed(),p(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),p(e)){if(p(t))return this.register(e,{useToken:t},{lifecycle:r.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:r.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var i=e;return t&&!p(t)&&(i=t),this.register(e,{useClass:i},{lifecycle:r.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new C),this.ensureNotDisposed();var i=this.getRegistration(e);if(!i&&p(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),i){var n=this.resolveRegistration(i,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if(function(e){return"function"==typeof e||e instanceof h}(e))return n=this.construct(e,t),this.executePostResolutionInterceptor(e,n,"Single"),n;throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var i,n;if(this.interceptors.preResolution.has(e)){var r=[];try{for(var o=a(this.interceptors.preResolution.getAll(e)),s=o.next();!s.done;s=o.next()){var c=s.value;"Once"!=c.options.frequency&&r.push(c),c.callback(e,t)}}catch(e){i={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}this.interceptors.preResolution.setAll(e,r)}},e.prototype.executePostResolutionInterceptor=function(e,t,i){var n,r;if(this.interceptors.postResolution.has(e)){var o=[];try{for(var s=a(this.interceptors.postResolution.getAll(e)),c=s.next();!c.done;c=s.next()){var l=c.value;"Once"!=l.options.frequency&&o.push(l),l.callback(e,t,i)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,o)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===r.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var i,n=e.options.lifecycle===r.Singleton,o=e.options.lifecycle===r.ContainerScoped,s=n||o;return i=m(e.provider)?e.provider.useValue:v(e.provider)?s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):d(e.provider)?s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):u(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===r.ResolutionScoped&&t.scopedResolutions.set(e,i),i},e.prototype.resolveAll=function(e,t){var i=this;void 0===t&&(t=new C),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&p(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var r=n.map((function(e){return i.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,r,"All"),r}var o=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,o,"All"),o},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var i=a(this._registry.entries()),n=i.next();!n.done;n=i.next()){var r=c(n.value,2),o=r[0],s=r[1];this._registry.setAll(o,s.filter((function(e){return!m(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,i;this.ensureNotDisposed();var n=new e(this);try{for(var o=a(this._registry.entries()),s=o.next();!s.done;s=o.next()){var l=c(s.value,2),d=l[0],u=l[1];u.some((function(e){return e.options.lifecycle===r.ContainerScoped}))&&n._registry.setAll(d,u.map((function(e){return e.options.lifecycle===r.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=o.return)&&i.call(o)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:i})},e.prototype.afterResolution=function(e,t,i){void 0===i&&(i={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:i})},e.prototype.dispose=function(){return e=this,t=void 0,n=function(){var e;return function(e,t){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}(this,(function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach((function(t){var i=t.dispose();i&&e.push(i)})),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))},new((i=void 0)||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}));var e,t,i,n},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var i=this;if(e instanceof h)return e.createProxy((function(e){return i.resolve(e,t)}));var n,r=function(){var n=E.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var r=n.map(i.resolveParams(t,e));return new(e.bind.apply(e,l([void 0],r)))}();return"function"!=typeof(n=r).dispose||n.dispose.length>0||this.disposables.add(r),r},e.prototype.resolveParams=function(e,t){var i=this;return function(n,r){var o,s,a,d;try{return"object"==typeof(d=n)&&"token"in d&&"multiple"in d?f(n)?n.multiple?(o=i.resolve(n.transform)).transform.apply(o,l([i.resolveAll(n.token)],n.transformArgs)):(s=i.resolve(n.transform)).transform.apply(s,l([i.resolve(n.token,e)],n.transformArgs)):n.multiple?i.resolveAll(n.token):i.resolve(n.token,e):f(n)?(a=i.resolve(n.transform,e)).transform.apply(a,l([i.resolve(n.token,e)],n.transformArgs)):i.resolve(n,e)}catch(e){throw new Error(function(e,t,i){var n,r,o,s,a=c(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1];return n="Cannot inject the dependency "+(s=t,(null===(o=void 0===a?null:a)?"at position #"+s:'"'+o.split(",")[s].trim()+'" at position #'+s)+' of "')+e.name+'" constructor. Reason:',void 0===r&&(r="    "),l([n],i.message.split("\n").map((function(e){return r+e}))).join("\n")}(t,r,e))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},e}(),T=new Q,O="injectionTokens";function j(e,t){return function(i,n,r){var o=Reflect.getOwnMetadata(O,i)||{};o[r]=t?{token:e,transform:t.transformToken,transformArgs:t.args||[]}:e,Reflect.defineMetadata(O,o,i)}}const I=function(e){return j(e)},R=function(){return function(e){E.set(e,function(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],i=Reflect.getOwnMetadata(O,e)||{};return Object.keys(i).forEach((function(e){t[+e]=i[e]})),t}(e))}},_=function(){return function(e){R()(e),T.registerSingleton(e)}},A=function(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return j(e,{transformToken:t,args:i})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.")},698:(e,t,i)=>{var n;!function(e){!function(t){var n="object"==typeof globalThis?globalThis:"object"==typeof i.g?i.g:"object"==typeof self?self:"object"==typeof this?this:function(){throw new ReferenceError("globalThis could not be found. Please polyfill globalThis before loading this module.")}(),r=o(e);function o(e,t){return function(i,n){Object.defineProperty(e,i,{configurable:!0,writable:!0,value:n}),t&&t(i,n)}}void 0!==n.Reflect&&(r=o(n.Reflect,r)),function(e,t){var i="function"==typeof Symbol,n=i&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:D("Symbol.toPrimitive not found."),r=i&&void 0!==Symbol.iterator?Symbol.iterator:D("Symbol.iterator not found."),o=Object.getPrototypeOf(Function),s="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:D("A valid Map constructor could not be found."),a="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:D("A valid Set constructor could not be found."),c="function"==typeof WeakMap?WeakMap:D("A valid WeakMap constructor could not be found."),l=i?Symbol.for("@reflect-metadata:registry"):void 0,d=function(){var e;return!C(l)&&S(t.Reflect)&&Object.isExtensible(t.Reflect)&&(e=t.Reflect[l]),C(e)&&(e=function(){var e,i,n,r;C(l)||void 0===t.Reflect||l in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(e=function(e){var t=e.defineMetadata,i=e.hasOwnMetadata,n=e.getOwnMetadata,r=e.getOwnMetadataKeys,o=e.deleteMetadata,s=new c;return{isProviderFor:function(e,t){var i=s.get(e);return!(C(i)||!i.has(t))||!!r(e,t).length&&(C(i)&&(i=new a,s.set(e,i)),i.add(t),!0)},OrdinaryDefineOwnMetadata:t,OrdinaryHasOwnMetadata:i,OrdinaryGetOwnMetadata:n,OrdinaryOwnMetadataKeys:r,OrdinaryDeleteMetadata:o}}(t.Reflect));var o=new c,d={registerProvider:u,getProvider:g,setProvider:f};return d;function u(t){if(!Object.isExtensible(d))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case e===t:break;case C(i):i=t;break;case i===t:break;case C(n):n=t;break;case n===t:break;default:void 0===r&&(r=new a),r.add(t)}}function h(t,o){if(!C(i)){if(i.isProviderFor(t,o))return i;if(!C(n)){if(n.isProviderFor(t,o))return i;if(!C(r))for(var s=R(r);;){var a=A(s);if(!a)return;var c=_(a);if(c.isProviderFor(t,o))return M(s),c}}}if(!C(e)&&e.isProviderFor(t,o))return e}function g(e,t){var i,n=o.get(e);return C(n)||(i=n.get(t)),C(i)?(C(i=h(e,t))||(C(n)&&(n=new s,o.set(e,n)),n.set(t,i)),i):i}function p(e){if(C(e))throw new TypeError;return i===e||n===e||!C(r)&&r.has(e)}function f(e,t,i){if(!p(i))throw new Error("Metadata provider not registered.");var n=g(e,t);if(n!==i){if(!C(n))return!1;var r=o.get(e);C(r)&&(r=new s,o.set(e,r)),r.set(t,i)}return!0}}()),!C(l)&&S(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,l,{enumerable:!1,configurable:!1,writable:!1,value:e}),e}(),u=function(e){var t=new c,i={isProviderFor:function(e,i){var n=t.get(e);return!C(n)&&n.has(i)},OrdinaryDefineOwnMetadata:function(e,t,i,r){n(i,r,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,i){var r=n(t,i,!1);return!C(r)&&E(r.has(e))},OrdinaryGetOwnMetadata:function(e,t,i){var r=n(t,i,!1);if(!C(r))return r.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var i=[],r=n(e,t,!1);if(C(r))return i;for(var o=R(r.keys()),s=0;;){var a=A(o);if(!a)return i.length=s,i;var c=_(a);try{i[s]=c}catch(e){try{M(o)}finally{throw e}}s++}},OrdinaryDeleteMetadata:function(e,i,r){var o=n(i,r,!1);if(C(o))return!1;if(!o.delete(e))return!1;if(0===o.size){var s=t.get(i);C(s)||(s.delete(r),0===s.size&&t.delete(s))}return!0}};return d.registerProvider(i),i;function n(n,r,o){var a=t.get(n),c=!1;if(C(a)){if(!o)return;a=new s,t.set(n,a),c=!0}var l=a.get(r);if(C(l)){if(!o)return;if(l=new s,a.set(r,l),!e.setProvider(n,r,i))throw a.delete(r),c&&t.delete(n),new Error("Wrong provider for target.")}return l}}(d);function h(e,t,i){if(g(e,t,i))return!0;var n=P(t);return!b(n)&&h(e,n,i)}function g(e,t,i){var n=x(t,i,!1);return!C(n)&&E(n.OrdinaryHasOwnMetadata(e,t,i))}function p(e,t,i){if(g(e,t,i))return f(e,t,i);var n=P(t);return b(n)?void 0:p(e,n,i)}function f(e,t,i){var n=x(t,i,!1);if(!C(n))return n.OrdinaryGetOwnMetadata(e,t,i)}function v(e,t,i,n){x(i,n,!0).OrdinaryDefineOwnMetadata(e,t,i,n)}function m(e,t){var i=y(e,t),n=P(e);if(null===n)return i;var r=m(n,t);if(r.length<=0)return i;if(i.length<=0)return r;for(var o=new a,s=[],c=0,l=i;c<l.length;c++){var d=l[c];o.has(d)||(o.add(d),s.push(d))}for(var u=0,h=r;u<h.length;u++)d=h[u],o.has(d)||(o.add(d),s.push(d));return s}function y(e,t){var i=x(e,t,!1);return i?i.OrdinaryOwnMetadataKeys(e,t):[]}function w(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function C(e){return void 0===e}function b(e){return null===e}function S(e){return"object"==typeof e?null!==e:"function"==typeof e}function k(e,t){switch(w(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var i=3===t?"string":5===t?"number":"default",r=I(e,n);if(void 0!==r){var o=r.call(e,i);if(S(o))throw new TypeError;return o}return function(e,t){if("string"===t){var i=e.toString;if(O(i)&&!S(r=i.call(e)))return r;if(O(n=e.valueOf)&&!S(r=n.call(e)))return r}else{var n;if(O(n=e.valueOf)&&!S(r=n.call(e)))return r;var r,o=e.toString;if(O(o)&&!S(r=o.call(e)))return r}throw new TypeError}(e,"default"===i?"number":i)}function E(e){return!!e}function Q(e){var t=k(e,3);return"symbol"==typeof t?t:function(e){return""+e}(t)}function T(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function O(e){return"function"==typeof e}function j(e){return"function"==typeof e}function I(e,t){var i=e[t];if(null!=i){if(!O(i))throw new TypeError;return i}}function R(e){var t=I(e,r);if(!O(t))throw new TypeError;var i=t.call(e);if(!S(i))throw new TypeError;return i}function _(e){return e.value}function A(e){var t=e.next();return!t.done&&t}function M(e){var t=e.return;t&&t.call(e)}function P(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===o)return t;if(t!==o)return t;var i=e.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return t;var r=n.constructor;return"function"!=typeof r||r===e?t:r}function D(e){throw e}function x(e,t,i){var n=d.getProvider(e,t);if(!C(n))return n;if(i){if(d.setProvider(e,t,u))return u;throw new Error("Illegal state.")}}e("decorate",(function(e,t,i,n){if(C(i)){if(!T(e))throw new TypeError;if(!j(t))throw new TypeError;return function(e,t){for(var i=e.length-1;i>=0;--i){var n=(0,e[i])(t);if(!C(n)&&!b(n)){if(!j(n))throw new TypeError;t=n}}return t}(e,t)}if(!T(e))throw new TypeError;if(!S(t))throw new TypeError;if(!S(n)&&!C(n)&&!b(n))throw new TypeError;return b(n)&&(n=void 0),function(e,t,i,n){for(var r=e.length-1;r>=0;--r){var o=(0,e[r])(t,i,n);if(!C(o)&&!b(o)){if(!S(o))throw new TypeError;n=o}}return n}(e,t,i=Q(i),n)})),e("metadata",(function(e,t){return function(i,n){if(!S(i))throw new TypeError;if(!C(n)&&!function(e){switch(w(e)){case 3:case 4:return!0;default:return!1}}(n))throw new TypeError;v(e,t,i,n)}})),e("defineMetadata",(function(e,t,i,n){if(!S(i))throw new TypeError;return C(n)||(n=Q(n)),v(e,t,i,n)})),e("hasMetadata",(function(e,t,i){if(!S(t))throw new TypeError;return C(i)||(i=Q(i)),h(e,t,i)})),e("hasOwnMetadata",(function(e,t,i){if(!S(t))throw new TypeError;return C(i)||(i=Q(i)),g(e,t,i)})),e("getMetadata",(function(e,t,i){if(!S(t))throw new TypeError;return C(i)||(i=Q(i)),p(e,t,i)})),e("getOwnMetadata",(function(e,t,i){if(!S(t))throw new TypeError;return C(i)||(i=Q(i)),f(e,t,i)})),e("getMetadataKeys",(function(e,t){if(!S(e))throw new TypeError;return C(t)||(t=Q(t)),m(e,t)})),e("getOwnMetadataKeys",(function(e,t){if(!S(e))throw new TypeError;return C(t)||(t=Q(t)),y(e,t)})),e("deleteMetadata",(function(e,t,i){if(!S(t))throw new TypeError;C(i)||(i=Q(i));var n=x(t,i,!1);return!C(n)&&n.OrdinaryDeleteMetadata(e,t,i)}))}(r,n),void 0===n.Reflect&&(n.Reflect=e)}()}(n||(n={}))},1635:(e,t,i)=>{"use strict";function n(e,t,i,n){var r,o=arguments.length,s=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,i,n);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,i,s):r(t,i))||s);return o>3&&s&&Object.defineProperty(t,i,s),s}function r(e,t){return function(i,n){t(i,n,e)}}function o(e,t,i,n){return new(i||(i=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))}i.d(t,{Cg:()=>n,Qj:()=>r,sH:()=>o}),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError}},n={};function r(e){var t=n[e];if(void 0!==t)return t.exports;var o=n[e]={exports:{}};return i[e](o,o.exports,r),o.exports}r.m=i,r.d=(e,t)=>{for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce(((t,i)=>(r.f[i](e,t),t)),[])),r.u=e=>(({23:"nr-agent",60:"compressor",158:"spa-aggregate",189:"session_trace-aggregate",211:"ajax-aggregate",214:"async-api",224:"fandom-gdpr-consents",297:"jserrors-aggregate",301:"page_action-aggregate",319:"static-consents",396:"lazy-feature-loader",452:"metrics-aggregate",482:"fanatical-consents",564:"basic-spa-aggregate",617:"page_view_timing-aggregate",677:"page_view_event-aggregate",777:"recorder",815:"session_replay-aggregate",832:"one-trust-consents",967:"session-manager"}[e]||e)+".js"),r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="identity-engine:",r.l=(i,n,o,s)=>{if(e[i])e[i].push(n);else{var a,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var u=l[d];if(u.getAttribute("src")==i||u.getAttribute("data-webpack")==t+o){a=u;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.setAttribute("data-webpack",t+o),a.src=i),e[i]=[n];var h=(t,n)=>{a.onerror=a.onload=null,clearTimeout(g);var r=e[i];if(delete e[i],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((e=>e(n))),t)return t(n)},g=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var i=t.getElementsByTagName("script");if(i.length)for(var n=i.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=i[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={57:0};r.f.j=(t,i)=>{var n=r.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var o=new Promise(((i,r)=>n=e[t]=[i,r]));i.push(n[2]=o);var s=r.p+r.u(t),a=new Error;r.l(s,(i=>{if(r.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=i&&("load"===i.type?"missing":i.type),s=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+s+")",a.name="ChunkLoadError",a.type=o,a.request=s,n[1](a)}}),"chunk-"+t,t)}};var t=(t,i)=>{var n,o,[s,a,c]=i,l=0;if(s.some((t=>0!==e[t]))){for(n in a)r.o(a,n)&&(r.m[n]=a[n]);c&&c(r)}for(t&&t(i);l<s.length;l++)o=s[l],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0},i=self.webpackChunkidentity_engine=self.webpackChunkidentity_engine||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),(()=>{"use strict";var e=r(1635),t=(r(698),r(2223));function i(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)e[n]=i[n]}return e}var n=function e(t,n){function r(e,r,o){if("undefined"!=typeof document){"number"==typeof(o=i({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var s="";for(var a in o)o[a]&&(s+="; "+a,!0!==o[a]&&(s+="="+o[a].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+s}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var i=document.cookie?document.cookie.split("; "):[],n={},r=0;r<i.length;r++){var o=i[r].split("="),s=o.slice(1).join("=");try{var a=decodeURIComponent(o[0]);if(n[a]=t.read(s,a),e===a)break}catch(e){}}return e?n[e]:n}},remove:function(e,t){r(e,"",i({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,i({},this.attributes,t))},withConverter:function(t){return e(i({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),o=r(5144),s=r(3858),a=r(7393),c=r(1695),l=r(6610);let d=class{constructor(e){this.adsContext=e}get(){var e;return"dev"===(null===(e=this.adsContext.get())||void 0===e?void 0:e.env)?"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/":"https://services.fandom.com/"}};d=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(l.i))],d);class u extends Error{constructor(e){super(e),this.name="GeoCookieException"}}let h=class{constructor(e,t,i,n,r){this.cookiesManager=e,this.httpClient=t,this.logger=i,this.geo=n,this.serviceBaseUrl=r,this.geoIPUrl=this.serviceBaseUrl.get()+"geoip/location"}setGeoCookieIfNotExist(){return(0,e.sH)(this,void 0,void 0,(function*(){if(this.cookiesManager.get("Geo"))this.logger.info("Geo cookie already exists");else try{const e=yield this.httpClient.get(this.geoIPUrl),{country_code:t,region:i,continent_code:n}=yield e.json(),r={country:t,region:i,continent:n},o=JSON.stringify(r);this.cookiesManager.set("Geo",o,{expires:365}),this.geo.set(r),this.logger.info("Geo cookie set")}catch(e){if(e instanceof s.j)throw new u(`Failed to fetch Geo cookie from pandora: ${e}`);throw new u(`Failed to set Geo cookie: ${e}`)}}))}};h=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(a.AZ)),(0,e.Qj)(1,(0,t.WQ)(s.Q)),(0,e.Qj)(2,(0,t.MR)(o.V,o.O,"GeoCookie")),(0,e.Qj)(3,(0,t.WQ)(c.u)),(0,e.Qj)(4,(0,t.WQ)(d))],h);var g=r(3155),p=r(2349),f=r(4085),v=r(4874),m=r(6167),y=r(2517);let w=class{constructor(e,t,i,n,r,o,s){this.cookiesManager=e,this.window=t,this.wikiConfig=i,this.context=n,this.logger=r,this.geo=o,this.communicationService=s,this.ageGateCookie="ag",this.ageGateExpiryMs=31536e6}init(t){return(0,e.sH)(this,void 0,void 0,(function*(){var e,i;Boolean(null===(i=null===(e=this.context.get())||void 0===e?void 0:e.targeting)||void 0===i?void 0:i.directedAtChildren)&&this.wikiConfig.get("wgAgeGateEnabled",!1)?void 0===this.cookiesManager.get(this.ageGateCookie)&&(yield this.waitForAgeGateDataAndSetCookie(t)):this.logger.info("disabled")}))}waitForAgeGateDataAndSetCookie(t){return(0,e.sH)(this,void 0,void 0,(function*(){return new Promise((e=>{t.on(p.c.AGE_GATE_DATA,(({payload:t})=>{this.setAgeGateCookie(t),"us"!==this.geo.getCountryCode()||t.adult||this.setUsPrivacyCookie(y.u.yes),this.updateConsents(!t.adult),e()}))}))}))}setAgeGateCookie(e){var t,i;e||this.logger.warn("Payload data missing, using defaults");const n=null!==(t=null==e?void 0:e.adult)&&void 0!==t&&t,r=null!==(i=null==e?void 0:e.timestamp)&&void 0!==i?i:Date.now();this.cookiesManager.set(this.ageGateCookie,n?"1":"0",{domain:this.getTopLevelDomain(),expires:new Date(r+this.ageGateExpiryMs)})}setUsPrivacyCookie(e){this.communicationService.emit(new g.r(p.c.UPDATE_CONSENT_COOKIE,{uspValue:e}))}getTopLevelDomain(){const e=this.window.location.hostname;return v.O.extract(e)}updateConsents(e){if(e){const t=this.geo.getCountryCode();this.communicationService.emit(new g.r(p.c.CONSENT_UPDATE,{ccpaSignal:e,geoRequiresSignal:"us"===t,gdprConsent:!e,geoRequiresConsent:this.geo.isGdprCountry()}))}}};w=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(a.AZ)),(0,e.Qj)(1,(0,t.WQ)(a.jf)),(0,e.Qj)(2,(0,t.WQ)(m.j)),(0,e.Qj)(3,(0,t.WQ)(l.i)),(0,e.Qj)(4,(0,t.MR)(o.V,o.O,"AgeGate")),(0,e.Qj)(5,(0,t.WQ)(c.u)),(0,e.Qj)(6,(0,t.WQ)(f.U))],w);var C=r(2712),b=r(4489),S=r(3841);let k=class{constructor(e,t,i){this.dataWarehouse=e,this.window=t,this.logger=i}activateTracking(){if(!this.isEnabled())return void this.logger.info("Hem Tracking is disabled");const e=this.extractHEMs();Object.keys(e).forEach((t=>{e[t]&&this.dataWarehouse.track(b.i.identity,{partner_name:"MediaWiki-"+t,partner_identity_id:e[t]})}))}isEnabled(){var e,t,i;return(null===(i=null===(t=null===(e=this.window.ads)||void 0===e?void 0:e.context)||void 0===t?void 0:t.opts)||void 0===i?void 0:i.userEmailHashes)&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){const[e,t,i]=this.window.ads.context.opts.userEmailHashes;return{md5:e,sha1:t,sha256:i}}};var E;k=(0,e.Cg)([(0,t._G)(),(0,e.Qj)(0,(0,t.WQ)(S.X)),(0,e.Qj)(1,(0,t.WQ)(a.jf)),(0,e.Qj)(2,(0,t.MR)(o.V,o.O,"HemTracking"))],k),function(e){e.tracking="tracking",e.page="page",e.site="site",e.partners="partners",e.targeting="targeting"}(E||(E={}));let Q=class{constructor(e){this.window=e}get(e,t){return this.window.fandomContext[e][t]}set(e,t,i){this.window.fandomContext&&this.window.fandomContext[e]||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{[e]:{}})),this.window.fandomContext[e][t]=i.value}remove(e,t){try{delete this.window.fandomContext[e][t]}catch(e){}}};Q=(0,e.Cg)([(0,t._G)(),(0,e.Qj)(0,(0,t.WQ)(a.jf))],Q);let T=class{constructor(e){this.cookiesManager=e}get(e){return this.cookiesManager.get(e)}set(e,t){const{value:i,domain:n,expiresMS:r}=t,o=new Date((new Date).getTime()+r);this.cookiesManager.set(e,i.toString(),{domain:n,expires:o})}remove(e){this.cookiesManager.remove(e)}};T=(0,e.Cg)([(0,t._G)(),(0,e.Qj)(0,(0,t.WQ)(a.AZ))],T);let O=class{generate(){let e="";for(;e.length<10;)e+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-"[64*Math.random()|0];return e}generateV2(){return`${this.generate()}.${Date.now()}`}};O=(0,e.Cg)([(0,t._G)()],O);let j=class{constructor(e){this.cookiesManager=e}getNextNumberFromCookie(e){const t=parseInt(this.cookiesManager.get(e));return Number.isNaN(t)?1:t+1}};j=(0,e.Cg)([(0,t._G)(),(0,e.Qj)(0,(0,t.WQ)(a.AZ))],j);const I=18e5,R=15552e6;let _=class{constructor(e,t,i,n,r,o,s,a){this.contextRepository=e,this.cookieRepository=t,this.uuid=i,this.beaconGenerator=n,this.pageViewNumberGenerator=r,this.window=o,this.wikiConfig=s,this.communicationService=a,this.communicationService.on(p.c.PAGE_CHANGED,(()=>{this.updatePageViewData()}))}set(e,t){this.contextRepository.set(E.tracking,e,t),this.cookieRepository.set(e,t)}remove(e){this.contextRepository.remove(E.tracking,e),this.cookieRepository.remove(e)}updatePageViewData(){const e=this.window.location.hostname,t=v.O.extract(e);this.contextRepository.set(E.tracking,"pvUID",{domain:e,expiresMS:I,value:this.wikiConfig.get("pvUID")||this.window.pvUID||this.uuid()}),this.set("pvNumber",{domain:e,expiresMS:I,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:t,expiresMS:I,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}updateUserTrackingData(){const e=this.window.location.hostname,t=v.O.extract(e),i=this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId"),n={domain:t,expiresMS:R,value:i||this.beaconGenerator.generate()};this.contextRepository.set(E.tracking,"beaconId",n),this.cookieRepository.set("wikia_beacon_id",n);const r={domain:t,expiresMS:63072e6,value:this.cookieRepository.get("_b2")||this.beaconGenerator.generateV2()};this.cookieRepository.set("_b2",r);const o=this.wikiConfig.get("sessionId",this.window.sessionId)||this.cookieRepository.get("sessionId"),s={domain:t,expiresMS:I,value:o||this.uuid()};this.set("sessionId",s);const a=this.cookieRepository.get("wikia_session_id");this.cookieRepository.set("wikia_session_id",{domain:t,expiresMS:R,value:a||this.beaconGenerator.generate()})}setup(){this.updateUserTrackingData(),this.updatePageViewData(),this.communicationService.emit(new g.r(p.c.FANDOM_CONTEXT_SET))}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};_=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(Q)),(0,e.Qj)(1,(0,t.WQ)(T)),(0,e.Qj)(2,(0,t.WQ)(a.kk)),(0,e.Qj)(3,(0,t.WQ)(O)),(0,e.Qj)(4,(0,t.WQ)(j)),(0,e.Qj)(5,(0,t.WQ)(a.jf)),(0,e.Qj)(6,(0,t.WQ)(m.j)),(0,e.Qj)(7,(0,t.WQ)(f.U))],_);let A=class{constructor(e){this.sentry=e}resolve(e,t,i){var n;e.geoRequiresConsent&&e.gdprConsent||e.geoRequiresSignal&&!e.ccpaSignal||!e.geoRequiresSignal&&!e.geoRequiresConsent?(this.consentGiven=!0,null===(n=t())||void 0===n||n.catch((e=>this.sentry.captureException(e)))):(e.geoRequiresSignal&&e.ccpaSignal||e.geoRequiresConsent&&!e.gdprConsent)&&(this.consentGiven=!1,i())}getConsents(){return this.consentGiven}};function M(e,t){return Object.keys(t).forEach((function(i){"default"===i||"__esModule"===i||e.hasOwnProperty(i)||Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[i]}})})),e}function P(e,t,i,n){Object.defineProperty(e,t,{get:i,set:n,enumerable:!0,configurable:!0})}A=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(a.eF))],A);var D={},x={};function N(e){return new Promise((t=>setTimeout((()=>t()),e)))}P(x,"delay",(()=>N));var L={};function W(){const e=new URLSearchParams(window.location.search.substring(1));return Boolean(e.get("adengine_debug"))?e.get("adengine_debug"):e.get("identity_debug")}P(L,"getDebugGroup",(()=>W));var G={};P(G,"localStorageHelper",(()=>U));class U{constructor(e,t=6e4){this.key=e,this.ttlInMilliseconds=t;let i=!1;try{i=void 0!==window.localStorage&&null!==window.localStorage,i&&(window.localStorage.setItem("__test__","test"),window.localStorage.removeItem("__test__"))}catch(e){i=!1}const n=e=>window?.instantConfigCache?.[e]??null,r=(e,t)=>{void 0===window.instantConfigCache&&(window.instantConfigCache={}),window.instantConfigCache[e]=t};this.storageAdapter={getItem:e=>{try{return i?window.localStorage.getItem(e)??n(e):n(e)}catch(t){return n(e)}},setItem:(e,t)=>{try{if(i)return localStorage.setItem(e,t);r(e,t)}catch(i){r(e,t)}}}}set(e){const t=this.getObjectToStore(e);this.storageAdapter.setItem(this.key,JSON.stringify(t))}get(){const e=this.storageAdapter.getItem(this.key);return e?this.parseStoredValue(JSON.parse(e)):null}expired(e){return!e||e<Date.now()}getObjectToStore(e){return{data:e,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(e){return this.expired(e?.ttl)?null:e.data}}var V={};P(V,"lock",(()=>H)),P(V,"release",(()=>$));const F=new U("instant-config-lock",1e3);function H(){return"lock"===F.get()||(F.set("lock"),!1)}function $(){F.set(null)}var B={};P(B,"getTimeDelta",(()=>Y)),P(B,"logger",(()=>J)),P(B,"warner",(()=>X));const q=W()||"",K=q.split(","),z=Date.now();function Y(){return((Date.now()-(window.performance?.timeOrigin??z))/1e3).toFixed(4)}function J(e,...t){""!==q&&("1"!==q&&-1===K.indexOf(e)||window.console.info(`${Y()}s\t\t ${e}`,t))}function X(e,...t){""!==q&&("1"!==q&&-1===K.indexOf(e)||window.console.warn(e,t))}M(D,x),M(D,L),M(D,G),M(D,V),M(D,B);var Z={},ee={};P(ee,"InstantConfigInterpreter",(()=>Oe));var te={},ie={};function ne(e){return Array.isArray(e)&&e.length>0&&"object"==typeof e[0]}function re(e){const t=e.sampling??e.s;return"number"==typeof t&&t>0&&t<100}P(ie,"shouldBeListOfConfigGroups",(()=>ne)),P(ie,"hasSampling",(()=>re));var oe={};P(oe,"negativePrefix",(()=>se)),P(oe,"cacheSuffix",(()=>ae)),P(oe,"samplingSeparator",(()=>ce)),P(oe,"worldWide",(()=>le)),P(oe,"precision",(()=>de)),P(oe,"experimentBucketSettingKey",(()=>ue));const se="non-",ae="-cached",ce="/",le="XX",de=10**6,ue="eb";M(te,ie),M(te,{}),M(te,{}),M(te,{}),M(te,{}),M(te,{}),M(te,{}),M(te,oe);class he{constructor(e,t,i){this.container=t,this.settingsRepository=i,"number"==typeof e?this.experimentBucket=this.manageSampling(e):!0===e?this.experimentBucket=this.manageSampling(0):!1===e&&this.clean()}build(){return()=>this.experimentBucket??he.getRandomBucket()}static getRandomBucket(){return Math.round(100*Math.random())}manageSampling(e){const t=this.readFromLoaderVariable()??this.readFromSettings()??he.getRandomBucket();return this.storeInLoaderVariable(t),this.storeInSettings(t,e),t}readFromLoaderVariable(){return this.container.fandomContext?.experimentBucket}readFromSettings(){const e=this.settingsRepository&&this.settingsRepository.get(ue);return e&&Number(e)}storeInSettings(e,t){this.settingsRepository&&this.settingsRepository.set(ue,e.toString(),t)}storeInLoaderVariable(e){this.container.fandomContext=this.container.fandomContext||{},this.container.fandomContext.experimentBucket=e}clean(){this.settingsRepository&&this.settingsRepository.remove(ue)}}class ge{activeKeyValues=[];activeLabradorKeyValues=[];constructor(e){Array.isArray(e)?this.keyValueNamesMap=e.map((e=>e&&e.toString().split(":"))).filter((e=>e&&e.length>=2)).reduce(((e,t)=>(e[t[0]]=t[1],e)),{}):this.keyValueNamesMap={}}getActiveKeyValues(){return this.activeKeyValues}getActiveLabradorKeyValues(){return this.activeLabradorKeyValues}mark(e,t,i){const n=`${e}_${i?"B":"A"}_${i?t:100-t}`,r=this.keyValueNamesMap[n]??n;this.activeKeyValues.includes(n)||this.activeKeyValues.push(n),this.activeLabradorKeyValues.includes(r)||this.activeLabradorKeyValues.push(r)}}var pe={},fe={};P(fe,"BrowserMatcher",(()=>ye));var ve={};function me(e){return e.startsWith(se)?{value:e.replace(se,""),negated:!0}:{value:e,negated:!1}}P(ve,"extractNegation",(()=>me));class ye{constructor(e){this.currentBrowser=e?.toLowerCase()}isValid(e){const t=e.b??e.browsers??[],i=t.map((e=>e.toLowerCase())).map((e=>me(e)));return 0===t.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,i)&&i.some((e=>this.currentBrowser.includes(e.value)!==e.negated))}isCurrentNegated(e,t){return t.some((t=>e.includes(t.value)&&t.negated))}}var we={};P(we,"DeviceMatcher",(()=>Ce));class Ce{constructor(e){this.currentDevice=e}isValid(e){const t=(e.d??e.devices??[]).map((e=>e.toLowerCase())).map((e=>me(e)));return 0===t.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,t)&&t.some((e=>e.value===this.currentDevice!==e.negated))}isCurrentNegated(e,t){return t.some((t=>e.includes(t.value)&&t.negated))}}var be={};P(be,"DomainMatcher",(()=>Se));class Se{isValid(e){const t=e.o??e.domains??[];return 0===t.length||t.some((e=>window.location.hostname.includes(e)))}}var ke={};P(ke,"RegionMatcher",(()=>Ee));class Ee{constructor(e){this.geo=e}isValid(e,t){const i=e.r??e.regions??[],n=this.filterOutInvalidRegions(i);return t?t(n):this.isProperGeo(n)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(e=[]){return!(!e||!e.indexOf||this.isGeoExcluded(e)||!(this.isProperContinent(e)||this.isProperCountry(e)||this.isProperRegion(e)))}filterOutInvalidRegions(e){return e.filter((e=>!e.includes(ce))).filter((e=>!e.includes(ae)))}isProperCountry(e){return!!(e&&e.indexOf&&(e.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(e,this.getCountryCode())))}isProperRegion(e){const t=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(e&&e.indexOf&&(e.indexOf(t)>-1||this.isSampledForGeo(e,t)))}containsContinent(e){const t=`${le}-${this.getContinentCode()}`;return e.indexOf(t)>-1||this.isSampledForGeo(e,t)}containsWorldWide(e){return e.indexOf(le)>-1||this.isSampledForGeo(e,le)}isProperContinent(e){return!(!e||!e.indexOf||!this.containsWorldWide(e)&&!this.containsContinent(e))}isGeoExcluded(e){return!!(e.indexOf(`${se}${this.getCountryCode()}`)>-1||e.indexOf(`${se}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||e.indexOf(`${se}${le}-${this.getContinentCode()}`)>-1)}hasSampling(e){return t=>0!==t.indexOf(se)&&t.indexOf(e+ce)>-1}getSamplingLimits(e){let[,t]=e.split(ce);return t=t.replace(ae,""),Math.round(parseFloat(t)*de)||0}isSampledForGeo(e,t){const i=e.filter(this.hasSampling(t));if(0===i.length)return!1;const n=Math.round(Math.random()*(100*de))||0;return i.map((e=>this.getSamplingLimits(e))).some((e=>n<e))}}var Qe={};P(Qe,"SamplingMatcher",(()=>Te));class Te{constructor(e){this.samplingProvider=e,this.precision=10**6}isValid(e){return Math.round(this.samplingProvider()*this.precision)<Math.round(e*this.precision)}}M(pe,fe),M(pe,we),M(pe,be),M(pe,ve),M(pe,ke),M(pe,Qe);class Oe{constructor(e=new ye,t=new Ce,i=new Se,n=new Ee,r){this.browserMatcher=e,this.deviceMatcher=t,this.domainMatcher=i,this.regionMatcher=n,this.settingsRepository=r,this.logGroup="instant-config-interpreter",this.configResponse={}}init(e,t={},i,n=window){return this.configResponse={...t,...e},this.regionValidationPredicate=i,this.labradorKeyValuesMapper=new ge(this.getValue("icLABradorGamKeyValues")),this.samplingMatcher=new Te(new he(this.getValue("icExperimentBucket"),n,this.settingsRepository).build()),this}getValues(){return D.logger(this.logGroup,"get values called with",this.configResponse),void 0===this.values&&(this.values=Object.keys(this.configResponse).reduce(((e,t)=>(e[t]=this.getValue(t),e)),{})),this.values}getValue(e){const t=this.configResponse[e];if(ne(t)){const i=t.find(this.predicate(e));return i?.v??i?.value}return t}getActiveKeyValues(){return this.labradorKeyValuesMapper.getActiveKeyValues()}getActiveLabradorKeyValues(){return this.labradorKeyValuesMapper.getActiveLabradorKeyValues()}predicate(e){return t=>{const i=this.browserMatcher.isValid(t)&&this.deviceMatcher.isValid(t)&&this.domainMatcher.isValid(t)&&this.regionMatcher.isValid(t,this.regionValidationPredicate);if(!re(t)||!1===i)return i;const n=t?.s??t?.sampling,r=this.samplingMatcher.isValid(n);return this.labradorKeyValuesMapper.mark(e,n,r),r}}}var je={};async function Ie(e,t=2e3){const i=new AbortController,n=setTimeout((()=>i.abort()),t),r=await fetch(e,{signal:i.signal});return clearTimeout(n),r}P(je,"InstantConfigLoader",(()=>_e));const Re="instant-config-loader";class _e{constructor(e,t=window){this.params=e,this.container=t,this.storage=new D.localStorageHelper(`instant-config-${e.appName}`,6e4),this.container.icbm=this.container.icbm||{},this.instantConfig=this.container.instantConfig,this.lockDelay="number"==typeof e.lockDelay?e.lockDelay:500}async getConfig(){if(this.instantConfig)return this.instantConfig;let e;return this.lockDelay>0?e=this.fetchInstantConfigThroughCache():(this.container.icbm.fetch||(this.container.icbm.fetch=this.fetchInstantConfig()),e=this.container.icbm.fetch),e.then((e=>e??this.fetchFallbackConfig()))}async fetchInstantConfigThroughCache(e=!1){if(D.lock()&&!e)return D.logger(Re,"locked, awaiting",this.lockDelay),await N(this.lockDelay),this.fetchInstantConfigThroughCache(!0);try{const e=this.storage.get();if(e)return D.logger(Re,"instant config pulled from local storage",e),JSON.parse(e);const t=await this.fetchInstantConfig();return t&&this.storage.set(JSON.stringify(t)),D.release(),t}catch(e){D.warner(Re,"could not get instant config via cache",e),D.release()}}async fetchInstantConfig(){const e=this.params.instantConfigEndpoint??"https://services.fandom.com",t=this.params.instantConfigVariant??"icbm",{appName:i,compact:n}=this.params,r=new URLSearchParams({app:i});n&&r.set("compact","true");const o=`${e}/${t}/api/config?${r.toString()}`;try{const e=await Ie(o,this.params.requestTimeout);if(!e.ok)return;const t=await e.json();return D.logger(Re,"instant config fetched",t),t}catch(e){return void D.warner(Re,"could not fetch instant config",e)}}async fetchFallbackConfig(){D.logger(Re,"Fetching fallback config");const e=this.params.instantConfigFallbackEndpoint;if(void 0===e)return{};try{D.logger(Re,e);const t=await Ie(e,this.params.requestTimeout);if(!t.ok)return{};const i=await t.json();return D.logger(Re,"fallback config fetched",i),i}catch(e){return D.warner(Re,"could not fetch fallback config",e),{}}}}var Ae={};P(Ae,"InstantConfigOverrider",(()=>Pe));const Me=["InstantGlobals","icbm"];class Pe{override(e,t){return[...e.keys()].filter((e=>{return t=e,Me.some((e=>t.startsWith(`${e}.`)||t.startsWith(`${e}__`)));var t})).map((e=>{const[,t]=e.split(".").map((e=>e.split("__"))).flat();return{paramKey:e,key:t}})).map((({paramKey:t,key:i})=>({key:i,value:this.parseValue(e.get(t))}))).reduce(((e,{key:t,value:i})=>({...e,[t]:i})),t)}parseValue(e){if("true"===e||"false"===e)return"true"===e;const t=parseInt(e,10);if(e===`${t}`)return t;try{return JSON.parse(e)}catch(t){return e||null}}}M(Z,ee),M(Z,je),M(Z,Ae),M(Z,pe);var De=r(1038),xe=r(3710),Ne=r(7546),Le=r(2439);class We{constructor(e,t,i){this.cookiesManager=e,this.communicationService=t,this.topLevelDomain=v.O.extract(i.location.hostname)}get(e){return this.cookiesManager.get(e)}remove(e){this.cookiesManager.remove(e,{domain:this.topLevelDomain})}set(e,t,i){this.communicationService.on(p.c.CONSENT_READY,(n=>{if((!n.geoRequiresSignal||!n.ccpaSignal)&&(!n.geoRequiresConsent||n.gdprConsent)){const n={domain:this.topLevelDomain};i&&(n.expires=i),this.cookiesManager.set(e,t,n)}}))}}let Ge=class{constructor(e,t,i,n,r,o,s,a,c){this.adsContext=e,this.device=t,this.browser=i,this.platform=n,this.geo=r,this.serviceBaseUrl=o,this.window=s,this.cookiesManager=a,this.logger=c,this.repository={}}init(t){return(0,e.sH)(this,arguments,void 0,(function*(e,t={}){var i;const n=null===(i=this.adsContext.get())||void 0===i?void 0:i.env,r=this.serviceBaseUrl.get().slice(0,-1),o=this.platform.get(),s=this.geo.get(),a=new _e({appName:o,instantConfigEndpoint:r,instantConfigFallbackEndpoint:`https://script.wikia.nocookie.net/fandom-ae-assets/icbm/${null!=n?n:"prod"}/icbm_state_${o}.json`,compact:!0}),c=new We(this.cookiesManager,e,this.window),l=new Oe(new ye(this.browser.getBrowser()),new Ce(this.device.getDeviceType()),new Se,new Ee(s),c);let d=yield a.getConfig();d=(new Pe).override(De.C.getURLSearchParams(),d);const u=l.init(d,t);return this.repository=u.getValues(),this.logger.info("instantiated with",this.repository),this}))}get(e,t){var i,n;return null!==(n=null===(i=this.repository)||void 0===i?void 0:i[e])&&void 0!==n?n:t}};var Ue;Ge=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(l.i)),(0,e.Qj)(1,(0,t.WQ)(xe.p)),(0,e.Qj)(2,(0,t.WQ)(Ne.P)),(0,e.Qj)(3,(0,t.WQ)(Le.O)),(0,e.Qj)(4,(0,t.WQ)(c.u)),(0,e.Qj)(5,(0,t.WQ)(d)),(0,e.Qj)(6,(0,t.WQ)(a.jf)),(0,e.Qj)(7,(0,t.WQ)(a.AZ)),(0,e.Qj)(8,(0,t.MR)(o.V,o.O,"InstantConfig"))],Ge),function(e){e.LOCAL="local",e.IDENTITY_STORAGE="identity_storage"}(Ue||(Ue={}));class Ve{constructor(e){this.storage=e}getItem(e){const t=this.storage.getItem(e);try{return null!==t?JSON.parse(t):null}catch(e){return t}}setItem(e,t){const i=t instanceof Object?JSON.stringify(t):t;this.storage.setItem(e,i)}removeItem(e){return this.storage.removeItem(e)}}let Fe=class{constructor(e){this.storageAdapter=new Ve(e.localStorage)}getItem(e){return this.storageAdapter.getItem(e)}setItem(e,t){try{this.storageAdapter.setItem(e,t)}catch(e){}}removeItem(e){return this.storageAdapter.removeItem(e)}};Fe=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(a.jf))],Fe);let He=class{constructor(e,t,i,n,r){this.logger=e,this.uuid=t,this.storage=i,this.serviceBaseUrl=n,this.httpClient=r,this.logGroup="identity-storage",this.IdentityStorageKey="identity",this.identityServiceUrl=this.serviceBaseUrl.get()+"identity-storage/"}fetchData(){return(0,e.sH)(this,void 0,void 0,(function*(){try{const e=yield this.httpClient.get(this.identityServiceUrl,{mode:"cors",credentials:"include"});return 200===e.status||202===e.status?e.json():this.createFallbackResponse()}catch(e){return this.logger.info(this.logGroup,"Loading Identity LocalStorage data failed",e),this.createFallbackResponse()}}))}postData(t){return(0,e.sH)(this,void 0,void 0,(function*(){const e={ppid:t.ppid},i=this.identityServiceUrl+"identity";return(yield this.httpClient.put(i,e,{mode:"cors",credentials:"include"})).json()}))}getLocalData(){return this.storage.getItem(this.IdentityStorageKey)}setLocalData(e){this.storage.setItem(this.IdentityStorageKey,e)}createFallbackResponse(){return{timestamp:Date.now(),over18:!1,synced:!1,ppid:this.uuid()}}};He=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.MR)(o.V,o.O,"UserIdentity")),(0,e.Qj)(1,(0,t.WQ)(a.kk)),(0,e.Qj)(2,(0,t.WQ)(Fe)),(0,e.Qj)(3,(0,t.WQ)(d)),(0,e.Qj)(4,(0,t.WQ)(s.Q))],He);let $e=class{constructor(e,t,i,n,r){this.logger=e,this.windowContextRepository=t,this.instantConfigService=i,this.identityStorageClient=n,this.sentry=r}get(){return(0,e.sH)(this,void 0,void 0,(function*(){const e=yield this.getLocalData();return e&&!e.synced&&this.setRemote(e),!e||this.isDeprecated(e)?this.getRemote():(this.setIdentityContextVariables(e),e)}))}setRemote(t){return(0,e.sH)(this,void 0,void 0,(function*(){try{yield this.identityStorageClient.postData(t);const e=Object.assign(Object.assign({},this.identityStorageClient.getLocalData()),{synced:!0});return this.setIdentityContextVariables(e),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},e),{timestamp:Date.now()})),e}catch(e){this.sentry.captureException(e),this.logger.error("Updating Identity LocalStorage data failed")}}))}isDeprecated(e){const t=this.instantConfigService.get("icIdentityTtl",6048e5),i=Date.now()-t;return!e.timestamp||e.timestamp-i<0}getLocalData(){return(0,e.sH)(this,void 0,void 0,(function*(){return this.identityStorageClient.getLocalData()}))}getRemote(){return(0,e.sH)(this,void 0,void 0,(function*(){const e=yield this.identityStorageClient.fetchData();return this.setIdentityContextVariables(e),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},e),{timestamp:Date.now()})),e}))}setIdentityContextVariables(e){e.over18&&this.windowContextRepository.set(E.tracking,"over_18",{value:"1"})}};$e=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.MR)(o.V,o.O,"UserIdentity")),(0,e.Qj)(1,(0,t.WQ)(Q)),(0,e.Qj)(2,(0,t.WQ)(Ge)),(0,e.Qj)(3,(0,t.WQ)(He)),(0,e.Qj)(4,(0,t.WQ)(a.eF))],$e);let Be=class{constructor(e,t){this.logger=e,this.identityStorageService=t}get(){return(0,e.sH)(this,void 0,void 0,(function*(){const e=yield this.identityStorageService.get();return this.logger.info(e),e.ppid}))}};Be=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.MR)(o.V,o.O,"UserIdentity")),(0,e.Qj)(1,(0,t.WQ)($e))],Be);let qe=class{constructor(e,t,i){this.logger=e,this.uuid=t,this.storage=i}get(){return Promise.resolve(this.storage.getItem("ppid")||this.generatePPID())}generatePPID(){this.logger.info("did not found a PPID in LocalStorage");const e=this.uuid();return this.storage.setItem("ppid",e),e}};qe=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.MR)(o.V,o.O,"UserIdentity")),(0,e.Qj)(1,(0,t.WQ)(a.kk)),(0,e.Qj)(2,(0,t.WQ)(Fe))],qe);let Ke=class{constructor(e,t,i,n,r,o,s){this.dataWarehouse=e,this.logger=t,this.windowContextRepository=i,this.instantConfigService=n,this.identityStorageRepository=r,this.localStorageRepository=o,this.communicationService=s}getPPID(e){switch(this.logger.info("active strategy: ",e),e){case Ue.IDENTITY_STORAGE:return this.identityStorageRepository;case Ue.LOCAL:default:return this.localStorageRepository}}generatePPID(){return(0,e.sH)(this,void 0,void 0,(function*(){try{const e=this.instantConfigService.get("icPpidRepository",Ue.LOCAL),t=yield this.getPPID(e).get();this.dataWarehouse.track(b.i.identity,{partner_name:"Google",partner_identity_id:t}),this.communicationService.emit(new g.r(p.c.IDENTITY_PARTNER_DATA_OBTAINED,{payload:{partnerName:"Google",partnerIdentityId:t}})),this.windowContextRepository.set(E.tracking,"ppid",{value:t}),this.logger.info("Passed PPID to page-level targeting")}catch(e){this.logger.error("Setting up PPID has failed!",e)}}))}setPpid(){return(0,e.sH)(this,void 0,void 0,(function*(){this.instantConfigService.get("icPpid",!1)?(this.logger.info("enabled - awaiting setup"),yield this.generatePPID()):this.logger.info("disabled")}))}};Ke=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(S.X)),(0,e.Qj)(1,(0,t.MR)(o.V,o.O,"UserIdentity")),(0,e.Qj)(2,(0,t.WQ)(Q)),(0,e.Qj)(3,(0,t.WQ)(Ge)),(0,e.Qj)(4,(0,t.WQ)(Be)),(0,e.Qj)(5,(0,t.WQ)(qe)),(0,e.Qj)(6,(0,t.WQ)(f.U))],Ke);let ze=class{constructor(e,t,i,n){this.window=e,this.logger=t,this.context=i,this.cookieRepository=n,this.createPartnersContext()}createPartnersContext(){this.window.fandomContext&&this.window.fandomContext.partners||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{partners:{}}))}setIsCoppaSubjectInContext(e){this.coppaSubject=e,this.window.fandomContext.partners.directedAtChildren=e,this.window.fandomContext.partners.blockthrough={directedAtChildren:e}}isCoppaSubject(){return void 0===this.coppaSubject?this.resolveCoppaStatus():this.coppaSubject}resolveCoppaStatus(){var e,t;if(!Boolean(null===(t=null===(e=this.context.get())||void 0===e?void 0:e.targeting)||void 0===t?void 0:t.directedAtChildren))return this.setIsCoppaSubjectInContext(!1),!1;try{const e="1"!==this.cookieRepository.get("ag");return this.setIsCoppaSubjectInContext(e),e}catch(e){this.logger.error("Error while reading age gate cookie")}}};ze=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(a.jf)),(0,e.Qj)(1,(0,t.MR)(o.V,o.O,"CoppaSubject")),(0,e.Qj)(2,(0,t.WQ)(l.i)),(0,e.Qj)(3,(0,t.WQ)(T))],ze);var Ye=r(8978);let Je=class{constructor(e,t,i,n,r){this.platform=t,this.window=i,this.httpClient=n,this.logger=r,this.enabled=!1,this.endpoint=`${e.get()}adeng/api/identity/metrics`}isReportingEnabled(e){const t=e.get("icMonitorTrafficThreshold",{identity:0});return!!(0,Ye.A)()||"object"==typeof(i=t)&&!Array.isArray(i)&&null!==i&&(null==t?void 0:t.identity)>0&&t.identity>=100*Math.random();var i}init(e){var t;this.enabled=this.isReportingEnabled(e),this.logger.info(`Metric reporter enabled: ${this.enabled}`),this.enabled&&("complete"===this.window.document.readyState?this.sendPerformanceMetrics():null===(t=this.window)||void 0===t||t.addEventListener("load",(()=>this.sendPerformanceMetrics())))}sendIdentityEngineState(e){this.enabled&&this.send(e)}sendConsentEvent(e){this.enabled&&this.send("opt"+(e?"in":"out"))}sendPerformanceMetrics(){const e=this.window.performance.getEntriesByType("navigation");if(e.length>0){const t=e[0].domContentLoadedEventEnd,i=e[0].loadEventEnd;this.send("document_content_loaded",Math.round(t>0?t:this.logger.getTimeDelta())),this.send("document_load_time",Math.round(i>0?i:this.logger.getTimeDelta()))}}send(e,t){if(!this.enabled)return;const i=new URL(this.endpoint);i.searchParams.set("app",this.platform.get()),i.searchParams.set("action",e),i.searchParams.set("duration",t?t.toString():Math.round(this.logger.getTimeDelta()).toString()),this.httpClient.get(i.toString(),{mode:"cors"},2e3).catch((()=>{this.logger.error("Failed to send data")}))}};Je=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(d)),(0,e.Qj)(1,(0,t.WQ)(Le.O)),(0,e.Qj)(2,(0,t.WQ)(a.jf)),(0,e.Qj)(3,(0,t.WQ)(s.Q)),(0,e.Qj)(4,(0,t.MR)(o.V,o.O,"MetricReporterService"))],Je);let Xe=class{constructor(e){this.storageAdapter=new Ve(e.sessionStorage)}getItem(e){return this.storageAdapter.getItem(e)}setItem(e,t){try{this.storageAdapter.setItem(e,t)}catch(e){}}removeItem(e){return this.storageAdapter.removeItem(e)}};Xe=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(a.jf))],Xe);var Ze=r(3248);let et=class{constructor(e,t,i,n,r,o,s){this.assetLoader=e,this.consentResolver=t,this.instantConfigService=i,this.coppaSubject=n,this.dataWarehouse=r,this.logger=o,this.metricReporter=s,this.partnerName="liveConnect",this.liveConnectScriptUrl="https://b-code.liadm.com/a-07ev.min.js",this.fallbackQf="0.3",this.live_connect_tracking_events={LIVE_CONNECT_STARTED:"live_connect_started",LIVE_CONNECT_CACHED:"live_connect_cached",LIVE_CONNECT_RESPONDED_UUID:"live_connect_responded_uuid"},this.idConfigMapping=[{id:"unifiedId",name:`${this.partnerName}-unifiedId`},{id:"sha2",name:this.partnerName,params:{qf:"0.3",resolve:"sha2"}},{id:"md5",name:`${this.partnerName}-md5`,params:{qf:"0.3",resolve:"md5"}},{id:"sha1",name:`${this.partnerName}-sha1`,params:{qf:"0.3",resolve:"sha1"}}]}isEnabled(){return this.consentResolver.getConsents()&&this.instantConfigService.get("icLiveConnect")&&this.instantConfigService.get("icLiveConnectCachingStrategy")&&this.instantConfigService.get("icIdentityPartners")&&!this.coppaSubject.isCoppaSubject()}init(){return(0,e.sH)(this,void 0,void 0,(function*(){this.isEnabled()?(this.setupStorage(),this.shouldLoadScript()?(this.logger.info("loading"),this.dataWarehouse.track(b.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_STARTED),this.assetLoader.loadScript(this.liveConnectScriptUrl,"text/javascript",!1).then((()=>{this.logger.info("loaded"),this.resolveAndTrackIds(),this.logEvent("live-connect-requested")}))):(this.dataWarehouse.track(b.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_CACHED),this.logger.info(`already loaded and available in ${this.storageConfig.type}Storage`))):this.logger.info("disabled")}))}resolveAndTrackIds(){var e;if(!window.liQ)return void this.logger.warn("window.liQ not available for tracking");const t=null===(e=this.instantConfigService.get("icLiveConnectQf"))||void 0===e?void 0:e.toString();window.liQ.resolve((e=>{this.trackIds(e)}),(e=>{console.error(e)}),{qf:t||this.fallbackQf,resolve:this.idConfigMapping.map((e=>e.id))})}trackIds(e){this.logger.info("resolve response:",e),Object.keys(e).forEach((t=>{if(!e[t])return;const i=this.getTrackingKeyName(t);if(this.isAvailableInStorage(i))return;"unifiedId"===t&&this.dataWarehouse.track(b.i.loadTime,this.live_connect_tracking_events.LIVE_CONNECT_RESPONDED_UUID);const n=e[t];this.logger.info(`${t}: ${n}`),n&&(this.storage.setItem(i,n,this.storageConfig.ttl),this.dataWarehouse.track(b.i.identity,{partner_name:i,partner_identity_id:n}))}))}getTrackingKeyName(e){var t;return null===(t=this.idConfigMapping.find((t=>t.id===e)))||void 0===t?void 0:t.name}setupStorage(){this.storageConfig=this.instantConfigService.get("icLiveConnectCachingStrategy"),"local"===this.storageConfig.type?this.storage=t.kL.resolve(Fe):this.storage=t.kL.resolve(Xe)}shouldLoadScript(){var e;if(!this.storageConfig)return!0;let t=!1;for(const i of this.storageConfig.mandatoryParams){const n=null===(e=this.idConfigMapping.find((e=>e.id===i)))||void 0===e?void 0:e.name;if(!this.isAvailableInStorage(n)){t=!0;break}}return t}isAvailableInStorage(e){return!!this.storage.getItem(e)}logEvent(e){this.metricReporter.send(e)}};et=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(Ze.s)),(0,e.Qj)(1,(0,t.WQ)((0,t.cb)((()=>A)))),(0,e.Qj)(2,(0,t.WQ)((0,t.cb)((()=>Ge)))),(0,e.Qj)(3,(0,t.WQ)(ze)),(0,e.Qj)(4,(0,t.WQ)(S.X)),(0,e.Qj)(5,(0,t.MR)(o.V,o.O,"liveConnect")),(0,e.Qj)(6,(0,t.WQ)(Je))],et);let tt=class{constructor(e,t,i){this.logger=e,this.contextRepository=t,this.liveConnect=i}createPartnersContext(){this.contextRepository.set(E.partners,"anyclip",{value:{ppid:this.contextRepository.get(E.tracking,"ppid")}})}initializeTargetingPartners(){return(0,e.sH)(this,void 0,void 0,(function*(){}))}initializeTrackingPartners(){return(0,e.sH)(this,void 0,void 0,(function*(){this.logger.info("Initializing partners"),yield Promise.all([this.liveConnect.init()])}))}};tt=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.MR)(o.V,o.O,"Partners")),(0,e.Qj)(1,(0,t.WQ)(Q)),(0,e.Qj)(2,(0,t.WQ)(et))],tt);let it=class{constructor(e,t,i,n){this.logger=e,this.windowContextRepository=t,this.dataWarehouse=i,this.navigator=n}init(){return(0,e.sH)(this,void 0,void 0,(function*(){var e;if(this.logger.info("FacilitatedTesting init"),null===(e=this.navigator.cookieDeprecationLabel)||void 0===e?void 0:e.getValue){const e=yield this.navigator.cookieDeprecationLabel.getValue();e?(this.logger.info(`Received cookieDeprecationLabel: ${e}`),this.windowContextRepository.set(E.tracking,"chromeLabel",{value:e}),this.dataWarehouse.track(b.i.chromeLabel,e)):this.logger.info("Received empty cookieDeprecationLabel")}else this.logger.info("cookieDeprecationLabel not available")}))}};it=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.MR)(o.V,o.O,"GooglePrivacySandbox:FacilitatedTesting")),(0,e.Qj)(1,(0,t.WQ)(Q)),(0,e.Qj)(2,(0,t.WQ)(S.X)),(0,e.Qj)(3,(0,t.WQ)(a.kW))],it);let nt=class{constructor(e,t){this.logger=e,this.facilitatedTesting=t}init(){this.logger.info("GooglePrivacySandbox init"),this.facilitatedTesting.init()}};nt=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.MR)(o.V,o.O,"GooglePrivacySandbox")),(0,e.Qj)(1,(0,t.WQ)(it))],nt);let rt=class{constructor(e,t,i,n){this.contextRepository=e,this.browser=t,this.coppaSubject=i,this.consentResolver=n}init(){return(0,e.sH)(this,void 0,void 0,(function*(){!this.coppaSubject.isCoppaSubject()&&this.consentResolver.getConsents()&&(this.setAdTargetingGroup(),this.setBrowser())}))}setBrowser(){this.contextRepository.set(E.targeting,"browser",{value:this.browser.getBrowser().split(" ")[0]})}getRandomGroup(){return 5*Math.ceil(Math.random()%20*20)}setAdTargetingGroup(){const e=this.getRandomGroup(),t=Array.from({length:21},((e,t)=>100-5*t)).filter((t=>t>=e&&t>0));this.contextRepository.set(E.targeting,"adGroup",{value:t.toString()})}};rt=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(Q)),(0,e.Qj)(1,(0,t.WQ)(Ne.P)),(0,e.Qj)(2,(0,t.WQ)(ze)),(0,e.Qj)(3,(0,t.WQ)(A))],rt);let ot=class{constructor(e,t,i){this.partnersService=e,this.adTargetingGroups=t,this.logger=i}initializeTargeting(){return(0,e.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up targeting"),yield this.partnersService.initializeTargetingPartners(),yield this.adTargetingGroups.init()}))}};ot=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(tt)),(0,e.Qj)(1,(0,t.WQ)(rt)),(0,e.Qj)(2,(0,t.MR)(o.V,o.O,"TargetingService"))],ot);let st=class{constructor(e,t,i,n,r){var o,s,a;this.sentry=e,this.browser=t,this.device=i,this.platform=n,this.geo=r,this.sentry.setTags({browser:this.browser.getBrowser(),device:this.device.getDeviceType(),platform:this.platform.get(),geo_country:null!==(o=this.geo.getCountryCode())&&void 0!==o?o:"",geo_continent:null!==(s=this.geo.getContinentCode())&&void 0!==s?s:"",geo_region:null!==(a=this.geo.getRegionCode())&&void 0!==a?a:""})}};st=(0,e.Cg)([(0,t._G)(),(0,e.Qj)(0,(0,t.WQ)(a.eF)),(0,e.Qj)(1,(0,t.WQ)(Ne.P)),(0,e.Qj)(2,(0,t.WQ)(xe.p)),(0,e.Qj)(3,(0,t.WQ)(Le.O)),(0,e.Qj)(4,(0,t.WQ)(c.u))],st);class at{constructor(e){this.options=e,this.tags={},this.errorQueue=[]}get inserted(){return Array.from(document.getElementsByTagName("script")).some((e=>e.src===at.SENTRY_SCRIPT_CDN_URL))}get shouldLoad(){return Math.random()<this.options.sampleRate&&void 0!==at.ALLOWED_URLS.find((e=>window.location.hostname.includes(e)))}get loaded(){return void 0!==window.Sentry}get initialized(){return void 0!==this.scope}setTags(e){this.tags=e}captureException(e){if(console.error(`[IE] (${this.options.release} ${this.options.environment}) Error captured:`,e),"development"!==this.options.environment&&this.shouldLoad){if(!this.inserted)return this.errorQueue.push(e),void this.loadSentry();if(!this.loaded)return this.errorQueue.push(e),void this.loadSentry();this.initialized||this.createSentryInstance(),this.scope.captureException(e)}}loadSentry(){return void 0===this.loadPromise&&(this.loadPromise=new Promise((e=>{const t=document.createElement("script");t.defer=!0,t.src=at.SENTRY_SCRIPT_CDN_URL,t.crossOrigin="anonymous",t.integrity=at.SENTRY_SCRIPT_INTEGRITY,t.onload=()=>{this.createSentryInstance(),this.flushErrorQueue(),e()},document.getElementsByTagName("script")[0].parentNode.append(t)}))),this.loadPromise}createSentryInstance(){const{breadcrumbsIntegration:e,BrowserClient:t,dedupeIntegration:i,defaultStackParser:n,httpContextIntegration:r,linkedErrorsIntegration:o,makeFetchTransport:s,Scope:a}=window.Sentry,c=new t(Object.assign(Object.assign({},this.options),{sampleRate:1,transport:s,stackParser:n,integrations:[e(),i(),r(),o()],beforeSend(e,t){const i=t.originalException;return i instanceof Error&&i.message.includes("Cannot inject the dependency")?null:e}}));this.scope=new a,this.scope.setClient(c),this.scope.setTags(Object.assign({url:window.location.href,userAgent:window.navigator.userAgent},this.tags))}flushErrorQueue(){this.errorQueue.forEach((e=>{var t;return null===(t=this.scope)||void 0===t?void 0:t.captureException(e)})),this.errorQueue.length=0}}at.ALLOWED_URLS=["fandom.com","fanatical.com","futhead.com","gamespot.com","giantbomb.com","metacritic.com","muthead.com","tvguide.com"],at.SENTRY_SCRIPT_CDN_URL="//browser.sentry-cdn.com/7.105.0/bundle.min.js",at.SENTRY_SCRIPT_INTEGRITY="sha384-iP5xIlbkWonIse3OwYtwpMAWScjrivRx8HUwVQK36MIK1LWXNF4oaIysvubyRK9V";let ct=class{constructor(e,t){this.window=e,this.logger=t,this.queue=[]}install(){this.logger.info("installing consent queue");const e=this;return this.window.consentCallbackQueue=this,this.window.consentCallback=(t,i,n)=>e.push(t,i,n),this}push(e,t,i){this.logger.warn("dialog not resolved, enqueued:",e),this.queue.push({name:e,callback:t,category:i})}};ct=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(a.jf)),(0,e.Qj)(1,(0,t.MR)(o.V,o.O,"ConsentCallbackQueue"))],ct);var lt=r(8569);const dt={C0001:"necessary",C0002:"performance",C0003:"functional",C0004:"targeting",C0005:"social"};class ut{constructor(e,t){this.container=e;const i=e.OptanonWrapper;e.OptanonWrapper=()=>{t.resolve(),null==i||i()}}available(){return void 0!==this.container.OneTrust}ready(){var e,t;const i=this.container.OneTrust;return void 0!==this.container.OnetrustActiveGroups&&("opt-in"!==(null===(t=null===(e=i.GetDomainData())||void 0===e?void 0:e.ConsentModel)||void 0===t?void 0:t.Name)||i.IsAlertBoxClosed())}resolve(){var e;return null===(e=this.container.OnetrustActiveGroups)||void 0===e?void 0:e.split(",").map((e=>dt[e])).filter((e=>e)).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:!0})),{})}}class ht{constructor(e,t){this.optIn=e,this.cookiesManager=t}available(){return void 0!==this.cookiesManager.get("OptanonConsent")}ready(){return!this.optIn||void 0!==this.cookiesManager.get("OptanonAlertBoxClosed")}resolve(){var e;const t=null===(e=decodeURIComponent(this.cookiesManager.get("OptanonConsent")))||void 0===e?void 0:e.match(/groups=([^&]+)/);return t&&t[1]?t[1].toUpperCase().split(",").map((e=>{const t=e.split(":");return"1"===t[1]?dt[t[0]]:void 0})).filter((e=>e)).reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:!0})),{}):{}}}const gt={necessary:!0},pt={necessary:!0,performance:!0,functional:!0,targeting:!0,social:!0};let ft=class{constructor(e,t,i,n){this.container=e,this.logger=t,this.geo=i,this.cookiesManager=n,this.queue=e.consentCallbackQueue,this.optIn=!!i&&lt.e.includes(this.geo.getCountryCode()),void 0!==this.queue&&this.init()}resolve(){return!!this.wasResolved()||(this.ifAvailableThenResolveIfReady(this.apiConsentResolver)?(this.logger.info("API available, resolved?:",this.categories),this.wasResolved()):!!this.ifAvailableThenResolveIfReady(this.cookieConsentResolver)&&(this.logger.info("Cookies available, resolved?:",this.categories),this.wasResolved()))}wasResolved(){return void 0!==this.categories}init(){this.logger.info("Setting up with opt-in status:",this.optIn),this.apiConsentResolver=new ut(this.container,this),this.cookieConsentResolver=new ht(this.optIn,this.cookiesManager),this.resolve()||setTimeout((()=>this.resolveWithFallback()),5e3)}resolveWithFallback(){this.resolve()||(this.apiConsentResolver.available()||this.cookieConsentResolver.available()?(this.logger.info("Still waiting for consent resolve with available api:",this.apiConsentResolver.available(),"or cookie:",this.cookieConsentResolver.available()),setTimeout((()=>this.resolveWithFallback),5e3)):(this.categories=this.fallback(),this.logger.info("Unable to resolve consent, fallback to:",this.categories),this.resolveQueue()))}ifAvailableThenResolveIfReady(e){const t=e.available();return t&&e.ready()&&(this.categories=e.resolve(),this.resolveQueue()),t}checkAndRun(e,t,i){return this.logger.info("About to callback:",e,"for:",i,"with:",this.categories),!(void 0!==i&&!this.categories[i]||(t(this.categories),0))}resolveQueue(){this.flushQueue(),this.queue.push=(e,t,i)=>this.checkAndRun(e,t,i),this.container.consentCallback=(e,t,i)=>this.checkAndRun(e,t,i)}flushQueue(){const e=this.queue.queue;this.logger.info("Consent resolved, flushing queue of size:",e.length);for(let t=e.length-1;t>=0;t--){const i=e[t];this.checkAndRun(i.name,i.callback,i.category)&&e.splice(t,1)}}fallback(){return this.optIn?gt:pt}};function vt(e){var t,i;return null===(i=null===(t=null==e?void 0:e.replace("/identity-service/",""))||void 0===t?void 0:t.replace("/index.js",""))||void 0===i?void 0:i.replace(/^v/,"")}ft=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(a.jf)),(0,e.Qj)(1,(0,t.MR)(o.V,o.O,"ConsentCallbackQueueHandler")),(0,e.Qj)(3,(0,t.WQ)(a.AZ))],ft);class mt{constructor(e){this.options=e,this.actionQueue=[],this.errorQueue=[],this.enabled=!1,this.loaded=!1,this.logger=new o.V(window),this.logger.setLoggerGroup("NewRelic")}init(t){return(0,e.sH)(this,void 0,void 0,(function*(){this.enabled=t.get("icNewRelic",!1),this.logger.info("NewRelic is "+(this.enabled?"enabled":"disabled"),this.options)}))}load(){return(0,e.sH)(this,void 0,void 0,(function*(){if(this.enabled&&!(Math.random()>this.options.sampleRate))return void 0===this.loadPromise&&(this.loadPromise=new Promise((e=>{this.logger.info("MicroAgent loaded"),r.e(23).then(r.bind(r,4167)).then((({MicroAgent:t})=>{this.agent=new t({info:{beacon:"bam.eu01.nr-data.net",errorBeacon:"bam.eu01.nr-data.net",licenseKey:"NRJS-b979b7ac62a2815b308",applicationID:"538605062",sa:1},loader_config:{accountID:"4475772",trustKey:"4475772",agentID:"538605062",licenseKey:"NRJS-b979b7ac62a2815b308",applicationID:"538605062"},init:{ajax:{enabled:!1},distributed_tracing:{enabled:!1},jserrors:{enabled:!0},metrics:{enabled:!0},page_action:{enabled:!0},page_view_timing:{enabled:!0},session_trace:{enabled:!1},session_replay:{enabled:!1},privacy:{cookies_enabled:!0},spa:{enabled:!1}}}),this.loaded=!0,this.flushQueue(),e()}))}))),this.loadPromise}))}captureException(e){var t;if(this.enabled){if(!this.loaded)return this.errorQueue.push(e),void this.load();this.logger.error("Error captured",e),null===(t=this.agent)||void 0===t||t.noticeError(e)}}addPageAction(e,t){var i;if(this.enabled){if(!this.loaded)return this.actionQueue.push([e,t]),void this.load();this.logger.info(`Reporting page action: ${e}`,null!=t?t:{}),null===(i=this.agent)||void 0===i||i.addPageAction(e,t)}}flushQueue(){this.actionQueue.forEach((([e,t])=>{var i;this.logger.info(`Reporting page action: ${e}`,null!=t?t:{}),null===(i=this.agent)||void 0===i||i.addPageAction(e,t)})),this.actionQueue.length=0,this.errorQueue.forEach((e=>{var t;this.logger.error("Error captured",e),null===(t=this.agent)||void 0===t||t.noticeError(e)})),this.errorQueue.length=0}}t.kL.register(a.AZ,{useValue:n}),t.kL.register(a.kk,{useValue:window.crypto.randomUUID.bind(window.crypto)}),t.kL.register(a.kW,{useValue:navigator}),t.kL.register(a.jf,{useValue:window}),t.kL.register(a.kW,{useValue:navigator});let yt=class{constructor(e,t,i,n,r,o,s,a,c,l,d,u,h,g,p,f,v,m,y){this.geoCookie=e,this.ageGateHandler=t,this.communicationService=i,this.optInService=n,this.hemTrackingService=r,this.trackingContextSetupService=o,this.consentResolver=s,this.instantConfigService=a,this.window=c,this.logger=l,this.ppidProvider=d,this.coppaSubject=u,this.metricReporterService=h,this.partnersService=g,this.googlePrivacySandbox=p,this.newRelic=f,this.targetingService=v}initializeAgeGateHandler(){return(0,e.sH)(this,void 0,void 0,(function*(){return this.ageGateHandler.init(this.communicationService)}))}updateGTMConsent(e){void 0===this.window.dataLayer&&(this.window.dataLayer=[]),this.window.dataLayer.push({event:"user-consent",consent:e.toString()})}initializeTracking(){return(0,e.sH)(this,void 0,void 0,(function*(){this.logger.info("Setting up tracking"),this.optInService.trackingAllowed=!0,this.hemTrackingService.activateTracking(),yield this.ppidProvider.setPpid(),yield this.partnersService.initializeTrackingPartners(),this.partnersService.createPartnersContext(),this.communicationService.emit(new g.r(p.c.IDENTITY_READY)),this.metricReporterService.sendIdentityEngineState("ready"),this.googlePrivacySandbox.init()}))}initializeTargeting(){return(0,e.sH)(this,void 0,void 0,(function*(){yield this.targetingService.initializeTargeting()}))}init(){return(0,e.sH)(this,void 0,void 0,(function*(){yield this.geoCookie.setGeoCookieIfNotExist(),yield this.instantConfigService.init(this.communicationService),this.optInService.init(this.instantConfigService),this.metricReporterService.init(this.instantConfigService),this.metricReporterService.sendIdentityEngineState("init"),this.newRelic.init(this.instantConfigService).then((()=>this.newRelic.addPageAction("identity-init")))}))}run(){var t,i;this.logger.info("Starting identity engine",`version: ${vt(null===(i=null===(t=this.window.ads)||void 0===t?void 0:t.version)||void 0===i?void 0:i.identity)}`),this.communicationService.once(p.c.CONSENT_READY,(t=>{this.trackingContextSetupService.setup(),this.consentResolver.resolve(t,(()=>(0,e.sH)(this,void 0,void 0,(function*(){this.metricReporterService.sendConsentEvent(!0),this.updateGTMConsent(!0),yield this.initializeAgeGateHandler(),this.coppaSubject.resolveCoppaStatus(),this.initializeTargeting(),yield this.initializeTracking(),this.newRelic.addPageAction("identity-ready",{consents:t,consent:"accepted"})}))),(()=>{this.metricReporterService.sendConsentEvent(!1),this.updateGTMConsent(!1),this.initializeTargeting(),this.coppaSubject.resolveCoppaStatus(),this.optInService.trackingAllowed=!1,this.loadPhoenixThirdPartyDisabledMode(),this.communicationService.emit(new g.r(p.c.IDENTITY_READY)),this.metricReporterService.sendIdentityEngineState("ready"),this.newRelic.addPageAction("identity-ready",{consents:t,consent:"rejected"}),this.logger.info("Tracking rejected")}))}))}loadPhoenixThirdPartyDisabledMode(){var e;(null===(e=null===window||void 0===window?void 0:window.PhoenixLoader)||void 0===e?void 0:e.triggerEvent)?(this.logger.info("Load third party in disabled mode"),window.PhoenixLoader.triggerEvent("loadThirdPartyDisabled")):this.logger.info("No PhoenixLoader.triggerEvent defined")}};yt=(0,e.Cg)([(0,t.Gr)(),(0,e.Qj)(0,(0,t.WQ)(h)),(0,e.Qj)(1,(0,t.WQ)(w)),(0,e.Qj)(2,(0,t.WQ)(f.U)),(0,e.Qj)(3,(0,t.WQ)(C.E)),(0,e.Qj)(4,(0,t.WQ)(k)),(0,e.Qj)(5,(0,t.WQ)(_)),(0,e.Qj)(6,(0,t.WQ)(A)),(0,e.Qj)(7,(0,t.WQ)(Ge)),(0,e.Qj)(8,(0,t.WQ)(a.jf)),(0,e.Qj)(9,(0,t.MR)(o.V,o.O,"IdentityEngine")),(0,e.Qj)(10,(0,t.WQ)(Ke)),(0,e.Qj)(11,(0,t.WQ)(ze)),(0,e.Qj)(12,(0,t.WQ)(Je)),(0,e.Qj)(13,(0,t.WQ)(tt)),(0,e.Qj)(14,(0,t.WQ)(nt)),(0,e.Qj)(15,(0,t.WQ)(a.LT)),(0,e.Qj)(16,(0,t.WQ)(ot)),(0,e.Qj)(17,(0,t.WQ)(ct)),(0,e.Qj)(18,(0,t.WQ)(ft))],yt),function(){(0,e.sH)(this,void 0,void 0,(function*(){var e,i;const n=function(){try{return"US"===t.kL.resolve(c.u).get().country?.01:.1}catch(e){return.01}}(),r=vt(null===(i=null===(e=window.ads)||void 0===e?void 0:e.version)||void 0===i?void 0:i.identity),o=new at({dsn:"https://3e92e20316cf4539a579d82f4294be77@o4504176096247808.ingest.sentry.io/4505432026447872",release:r,environment:"production",sampleRate:n}),s=new mt({version:`v${r}`,sampleRate:n});try{t.kL.register(a.eF,{useValue:o}),t.kL.register(a.LT,{useValue:s}),t.kL.resolve(st);const e=t.kL.resolve(yt);yield e.init(),e.run()}catch(e){o.captureException(e),s.captureException(e)}}))}()})()})();
//# sourceMappingURL=index.js.map